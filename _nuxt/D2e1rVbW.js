var Qt=Object.defineProperty;var te=(o,t,e)=>t in o?Qt(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var Ot=(o,t,e)=>te(o,typeof t!="symbol"?t+"":t,e);import{I as Tt,k as H,d as _t,r as ot,o as xt,J as Ft,x as N,y as G,z as f,B as $,C as kt,K as bt,A as P,L as m,T as Lt,D as q,_ as Ut,M as O,a as ee,N as se,O as Rt,P as ie,G as ae,Q as nt,R as Ht,S as jt,s as B,U as oe,V as Wt,W as ne,X as re,Y as dt,Z as ut,$ as Gt,a0 as le,a1 as ce,a2 as he,a3 as de,a4 as ue,a5 as fe,a6 as pe}from"./-GFAltTW.js";import Xt from"./CwQwwyiT.js";const x={POINT_COUNT:60,MAX_METEORS:20,GRAVITY_RADIUS_BASE:700,START_RADIUS:20,CRITICAL_MASS:300,MASS_GAIN_METEOR:2,MASS_GAIN_SHIP:10,BOMB_DAMAGE:6,SHIP_COUNT:4,SHIP_SPEED:4,SHIP_TURN_SPEED:.12,SHIP_SEPARATION:80,SHIP_ENGAGEMENT_DIST:600,POWERUP_RATE:.015,POWERUP_DURATION:600,SIZE_MODIFIER_BIG:1.8,SIZE_MODIFIER_SMALL:.6,COLORS:{primary:"#8b5cf6",secondary:"#06b6d4",danger:"#f43f5e",repel:"#f59e0b",shipEngines:"#facc15",white:"#ffffff",bg:"#0a0a0a",bomb:"#ef4444",buff:"#10b981",debuff:"#a855f7",shield:"#3b82f6"}},F={ROAM:"ROAM",DOGFIGHT:"DOGFIGHT",PANIC:"PANIC"},j={SERPENT:"SERPENT",SHIP:"SHIP",POINT:"POINT",POWERUP:"POWERUP"},st={CHARGE:"CHARGE",FLANK:"FLANK",RETREAT:"RETREAT"};var T=(o=>(o[o.STABLE=0]="STABLE",o[o.UNSTABLE=1]="UNSTABLE",o[o.EXPLODING=2]="EXPLODING",o[o.REFORMING=3]="REFORMING",o))(T||{});class u{static dist(t,e){const s=t.x-e.x,i=t.y-e.y;return Math.sqrt(s*s+i*i)}static angle(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}static randomRange(t,e){return Math.random()*(e-t)+t}static randomChoice(t){if(t.length===0)throw new Error("Array is empty");return t[Math.floor(Math.random()*t.length)]}static normalizeAngle(t){let e=t;for(;e<-Math.PI;)e+=Math.PI*2;for(;e>Math.PI;)e-=Math.PI*2;return e}static randomColor(){const t=Math.floor(Math.random()*360),e=Math.floor(Math.random()*30)+70,s=Math.floor(Math.random()*40)+40;return`hsl(${t}, ${e}%, ${s}%)`}}class W{x;y;vx=0;vy=0;color;markedForDeletion=!1;constructor(t,e,s){this.x=t,this.y=e,this.color=s}applyPhysics(t=1,e=1){this.x+=this.vx*t,this.y+=this.vy*t,this.vx*=e,this.vy*=e}}class pt{static checkCircleCollision(t,e,s,i){return u.dist(t,e)<s+i}static checkPointInCircle(t,e,s){return u.dist(t,e)<s}static checkSegmentCollision(t,e,s,i){for(const a of e)if(this.checkCircleCollision(t,a,i,s))return!0;return!1}static checkShipCollision(t,e,s,i){const a=s*(e.sizeMult||1);return this.checkCircleCollision(t,e,i,a)}}class yt extends W{damage;size;life;maxLife;constructor(t,e,s,i,a,r,n,l){super(t,e,a),this.vx=s,this.vy=i,this.damage=r,this.size=n,this.life=l,this.maxLife=l}checkCollisions(t){for(const e of t.ships)if(e.color!==this.color&&pt.checkShipCollision(this,e,12,this.size)){this.onHitShip(t,e);return}for(const e of t.serpents)if(e.segments.length>0){const s=20*(e.sizeMult||1);if(pt.checkCircleCollision(this,e.segments[0],this.size,s)){this.onHitSerpent(t,e);return}}}onHitShip(t,e){e.takeDamage(t,this.damage),this.createHitEffect(t),this.markedForDeletion=!0}onHitSerpent(t,e){e.takeDamage(t,this.damage),this.createHitEffect(t),this.markedForDeletion=!0}createHitEffect(t){t.createExplosion(this.x,this.y,5,this.color)}update(t){if(this.life--,this.life<=0){this.markedForDeletion=!0;return}this.applyPhysics(t.warpFactor),this.checkCollisions(t)}}class z{getIcon(){return this.icon}}class ge extends z{type="HEAL";duration=0;icon="â¤ï¸";weight=7;isGood=!0;apply(t){if(t.hp!==void 0&&t.maxHp!==void 0){const e=t instanceof gt?10:2;t.hp=Math.min(t.hp+e,t.maxHp)}}}class xe extends z{type="SPEED_BOOST";duration=x.POWERUP_DURATION;icon="âš¡";weight=8;isGood=!0;apply(t){const e=t.activeEffects.find(s=>s.type===this.type);e?e.timer=this.duration:(t.activeEffects.push({type:this.type,timer:this.duration}),t.statusIcons.includes(this.icon)||t.statusIcons.push(this.icon))}updateEffect(t,e){t.speedMult!==void 0&&(t.speedMult=1.8)}removeEffect(t){const e=t.statusIcons.indexOf(this.icon);e>-1&&t.statusIcons.splice(e,1)}}class ye extends z{type="DAMAGE_BOOST";duration=x.POWERUP_DURATION;icon="âš”ï¸";weight=7;isGood=!0;apply(t){const e=t.activeEffects.find(s=>s.type===this.type);e?e.timer=this.duration:(t.activeEffects.push({type:this.type,timer:this.duration}),t.statusIcons.includes(this.icon)||t.statusIcons.push(this.icon))}updateEffect(t,e){if(t.damageMult!==void 0){const s="segments"in t;t.damageMult=s?2:3}}removeEffect(t){const e=t.statusIcons.indexOf(this.icon);e>-1&&t.statusIcons.splice(e,1)}}class ve extends z{type="RAPID_FIRE";duration=x.POWERUP_DURATION;icon="ðŸ”¥";weight=0;isGood=!0;apply(t){const e=t.activeEffects.find(s=>s.type===this.type);e?e.timer=this.duration:(t.activeEffects.push({type:this.type,timer:this.duration}),t.statusIcons.includes(this.icon)||t.statusIcons.push(this.icon))}updateEffect(t,e){t.reloadMult!==void 0&&(t.reloadMult=4)}removeEffect(t){const e=t.statusIcons.indexOf(this.icon);e>-1&&t.statusIcons.splice(e,1)}}class me extends z{type="SLOW_DOWN";duration=x.POWERUP_DURATION;icon="â„ï¸";weight=6;isGood=!1;apply(t){const e=t.activeEffects.find(s=>s.type===this.type);e?e.timer=this.duration:(t.activeEffects.push({type:this.type,timer:this.duration}),t.statusIcons.includes(this.icon)||t.statusIcons.push(this.icon))}updateEffect(t,e){t.speedMult!==void 0&&(t.speedMult=.5)}removeEffect(t){const e=t.statusIcons.indexOf(this.icon);e>-1&&t.statusIcons.splice(e,1)}}class we extends z{type="WEAPON_JAM";duration=x.POWERUP_DURATION;icon="ðŸš«";weight=2;isGood=!1;apply(t){const e=t.activeEffects.find(s=>s.type===this.type);e?e.timer=this.duration:(t.activeEffects.push({type:this.type,timer:this.duration}),t.statusIcons.includes(this.icon)||t.statusIcons.push(this.icon))}updateEffect(t,e){t.isJammed!==void 0&&(t.isJammed=!0)}removeEffect(t){const e=t.statusIcons.indexOf(this.icon);e>-1&&t.statusIcons.splice(e,1)}}class be extends z{type="SIZE_UP";duration=600;icon="âž•";weight=5;isGood=!0;apply(t){const e=t.activeEffects.find(s=>s.type===this.type);e?e.timer=this.duration:(t.activeEffects.push({type:this.type,timer:this.duration}),t.statusIcons.includes(this.icon)||t.statusIcons.push(this.icon))}updateEffect(t,e){t.sizeMult!==void 0&&(t.sizeMult=x.SIZE_MODIFIER_BIG)}removeEffect(t){const e=t.statusIcons.indexOf(this.icon);e>-1&&t.statusIcons.splice(e,1),t.sizeMult!==void 0&&(t.sizeMult=1)}}class Me extends z{type="SIZE_DOWN";duration=600;icon="âž–";weight=5;isGood=!0;apply(t){const e=t.activeEffects.find(s=>s.type===this.type);e?e.timer=this.duration:(t.activeEffects.push({type:this.type,timer:this.duration}),t.statusIcons.includes(this.icon)||t.statusIcons.push(this.icon))}updateEffect(t,e){t.sizeMult!==void 0&&(t.sizeMult=x.SIZE_MODIFIER_SMALL)}removeEffect(t){const e=t.statusIcons.indexOf(this.icon);e>-1&&t.statusIcons.splice(e,1),t.sizeMult!==void 0&&(t.sizeMult=1)}}class Se extends z{type="GET_SHIELD";duration=0;icon="ðŸ›¡ï¸";weight=5;isGood=!0;apply(t){t.shield!==void 0&&t.maxShield!==void 0&&(t.shield=t.maxShield)}}class Ee extends z{type="GET_TELEPORT";duration=0;icon="ðŸŒ€";weight=5;isGood=!0;apply(t){t.hasTeleport!==void 0&&(t.hasTeleport=!0)}tryTeleport(t,e){if(!t.hasTeleport||t.state!==F.DOGFIGHT||!t.navTarget)return!1;if(u.dist(t,t.navTarget)>400){const i=u.angle(t,t.navTarget);return t.x=t.navTarget.x-Math.cos(i)*100,t.y=t.navTarget.y-Math.sin(i)*100,e.createExplosion(t.x,t.y,20,x.COLORS.shield),t.hasTeleport=!1,!0}return!1}}function K(o,t){o.shadowColor=t.color,o.shadowBlur=t.blur*t.intensity,t.spread!==void 0&&(o.shadowOffsetX=0,o.shadowOffsetY=0)}function Te(o,t,e=1){return o*(.7+.3*Math.sin(t*e))}class rt{static calculateGravityPull(t,e){if(e.state===T.EXPLODING)return null;const s=u.dist(t,e),i=u.angle(t,e),a=.1+e.mass/x.CRITICAL_MASS*.9,r=x.GRAVITY_RADIUS_BASE*(.5+a*.5);if(s<r){const n=.3*a*(1-s/r);return{vx:Math.cos(i)*n,vy:Math.sin(i)*n}}return null}static shouldDieFromGravity(t,e){return e.state===T.EXPLODING?!1:u.dist(t,e)<e.visualRadius}static shouldDieFromShockwave(t,e){return e.state!==T.EXPLODING?!1:u.dist(t,e)<e.shockwaveRadius+50}}class _e extends yt{constructor(t,e,s,i,a){super(t,e,s,i,x.COLORS.bomb,a,4,300)}update(t){const e=t.blackHole;if(e.state!==T.EXPLODING){const i=rt.calculateGravityPull(this,e);i&&(this.vx+=i.vx*2.67,this.vy+=i.vy*2.67)}if(this.x+=this.vx*t.warpFactor,this.y+=this.vy*t.warpFactor,this.life--,u.dist(this,e)<e.visualRadius&&e.state!==T.EXPLODING){t.createExplosion(this.x,this.y,30,this.color),e.mass=Math.max(0,e.mass-this.damage),e.shake=10,t.spawnShockwave(this.x,this.y),this.markedForDeletion=!0;return}for(const i of t.serpents)if(pt.checkSegmentCollision(this,i.segments,30,0)){i.takeDamage(t,100),t.createExplosion(this.x,this.y,40,this.color),t.spawnShockwave(this.x,this.y),this.markedForDeletion=!0;return}this.life<=0&&(this.markedForDeletion=!0)}drawSpecific(t){t.save(),K(t,{color:this.color,intensity:1,blur:25}),t.beginPath(),t.arc(0,0,4,0,Math.PI*2),t.fillStyle=this.color,t.fill(),t.restore()}}class Re extends z{type="UPGRADE_BOMB";duration=0;icon="ðŸ’£";weight=5;isGood=!0;apply(t){t.bombLevel!==void 0&&(t.bombLevel=2)}tryFireBomb(t,e){if(t.bombLevel===void 0||t.bombLevel<1||t.bombCooldown>0)return!1;const s=e.blackHole,i=u.angle(t,s),a=Math.abs(u.normalizeAngle(i-t.angle)),r=u.dist(t,s);return a<.5&&r<500&&s.state!==T.EXPLODING?(t.bombLevel===2?x.BOMB_DAMAGE*2:x.BOMB_DAMAGE,e.spawnBomb(t.x,t.y,t.vx,t.vy,t.angle,t.bombLevel),t.bombCooldown=400,!0):!1}}class Pe extends z{type="UPGRADE_RANGE";duration=0;icon="ðŸ”­";weight=5;isGood=!0;apply(t){t.rangeMult!==void 0&&(t.rangeMult=1.5)}}class X{cooldownTimer=0;cachedVisual=null;update(){this.cooldownTimer>0&&this.cooldownTimer--}get isReady(){return this.cooldownTimer<=0}fire(t,e,s,i,a){return this.isReady?(this.spawnProjectiles(t,e,s,i),this.cooldownTimer=this.config.cooldown/a,!0):!1}getVisual(t,e){return this.cachedVisual||(this.cachedVisual=this.generateVisual(t,e)),this.cachedVisual}getAllowedAngle(){return .5}getRange(t){return t+100}}class et extends yt{drawSpecific(t){const e=Math.atan2(this.vy,this.vx);t.rotate(e);const s=this.size>3?30:10;t.save(),K(t,{color:this.color,intensity:1,blur:15+this.size*5}),t.beginPath(),t.moveTo(0,0),t.lineTo(-s,0),t.strokeStyle=this.color,t.lineWidth=this.size,t.stroke(),t.restore()}}class Ie{cache=new Map;maxSize=100;createCanvas(t,e){const s=document.createElement("canvas");return s.width=t,s.height=e,s}get(t){return this.cache.get(t)}set(t,e){if(this.cache.size>=this.maxSize){const s=this.cache.keys().next().value;s&&this.cache.delete(s)}this.cache.set(t,e)}has(t){return this.cache.has(t)}clear(){this.cache.clear()}generateKey(t,e){const s=Object.entries(e).sort(([i],[a])=>i.localeCompare(a)).map(([i,a])=>`${i}:${a}`).join("|");return`${t}:${s}`}}const V=new Ie;class De extends X{config={cooldown:5,damage:.3,speed:14,spread:.3,color:"#f59e0b",size:1.5};icon="âˆ´";duration=400;getAllowedAngle(){return .8}spawnProjectiles(t,e,s,i){const a=(Math.random()-.5)*this.config.spread,r=e.vx+Math.cos(s+a)*this.config.speed,n=e.vy+Math.sin(s+a)*this.config.speed;t.projectiles.push(new et(e.x,e.y,r,n,this.config.color,this.config.damage*i,this.config.size,50))}generateVisual(t,e){const s=V.createCanvas(t,e),i=s.getContext("2d");i.save(),i.strokeStyle="#f59e0b",i.shadowColor="#f59e0b",i.shadowBlur=20,i.lineWidth=1.5;for(let a=0;a<3;a++)i.beginPath(),i.moveTo(t/2,e/2),i.lineTo(t/2-15-a*2,e/2+(Math.random()-.5)*4),i.stroke();return i.restore(),{canvas:s,width:t,height:e,key:"minigun"}}}class Ae extends X{config={cooldown:60,damage:.8,speed:10,spread:.4,color:"#ef4444",size:2,count:5};icon="â‹—";duration=500;spawnProjectiles(t,e,s,i){const a=this.config.count||5;for(let r=0;r<a;r++){const n=(Math.random()-.5)*this.config.spread,l=e.vx+Math.cos(s+n)*this.config.speed,h=e.vy+Math.sin(s+n)*this.config.speed;t.projectiles.push(new et(e.x,e.y,l,h,this.config.color,this.config.damage*i,this.config.size,40))}}generateVisual(t,e){const s=V.createCanvas(t,e),i=s.getContext("2d");i.save(),i.strokeStyle="#ef4444",i.shadowColor="#ef4444",i.shadowBlur=18,i.lineWidth=2;const a=t/2,r=e/2;for(let n=0;n<5;n++){const l=-.4+n*.2;i.beginPath(),i.moveTo(a,r),i.lineTo(a+Math.cos(l)*18,r+Math.sin(l)*18),i.stroke()}return i.restore(),{canvas:s,width:t,height:e,key:"shotgun"}}}class Ce extends X{config={cooldown:100,damage:10,speed:40,spread:0,color:"#06b6d4",size:4};icon="â”";duration=800;spawnProjectiles(t,e,s,i){const a=e.vx+Math.cos(s)*this.config.speed,r=e.vy+Math.sin(s)*this.config.speed;t.projectiles.push(new et(e.x,e.y,a,r,this.config.color,this.config.damage*i,this.config.size,30))}generateVisual(t,e){const s=V.createCanvas(t,e),i=s.getContext("2d");return i.save(),i.strokeStyle="#06b6d4",i.shadowColor="#06b6d4",i.shadowBlur=25,i.lineWidth=4,i.beginPath(),i.moveTo(t/2,e/2),i.lineTo(t/2-30,e/2),i.stroke(),i.restore(),{canvas:s,width:t,height:e,key:"railgun"}}}class Oe extends X{config={cooldown:120,damage:4,speed:5,spread:.2,color:"#ec4899",size:3};icon="ðŸš€";duration=700;getRange(t){return 1e3}spawnProjectiles(t,e,s,i){const a=(Math.random()-.5)*this.config.spread,r=e.vx+Math.cos(s+a)*this.config.speed,n=e.vy+Math.sin(s+a)*this.config.speed;t.projectiles.push(new Yt(e.x,e.y,r,n,this.config.color,this.config.damage*i))}generateVisual(t,e){const s=V.createCanvas(t,e),i=s.getContext("2d");i.save();const a=t/2,r=e/2;return i.fillStyle="#ec4899",i.shadowColor="#ec4899",i.shadowBlur=20,i.beginPath(),i.moveTo(a+6,r),i.lineTo(a-4,r+4),i.lineTo(a-4,r-4),i.fill(),i.strokeStyle="#f59e0b",i.shadowColor="#f59e0b",i.shadowBlur=15,i.lineWidth=2,i.beginPath(),i.moveTo(a-4,r),i.lineTo(a-10,r),i.stroke(),i.restore(),{canvas:s,width:t,height:e,key:"missile"}}}class Pt extends yt{pattern;initialV;spawnTime;constructor(t,e,s,i,a,r,n,l){super(t,e,s,i,a,r,n,60),this.pattern=l,this.initialV={x:s,y:i},this.spawnTime=Date.now(),l==="PLASMA"&&(this.life=100)}update(t){if(this.pattern==="WAVE"){const e=(Date.now()-this.spawnTime)*.015,s=-this.initialV.y,i=this.initialV.x,a=Math.sqrt(s*s+i*i)||1,r=Math.sin(e)*4;this.x+=s/a*r*.2,this.y+=i/a*r*.2}else if(this.pattern==="FLAK"&&this.life<10){for(let e=0;e<6;e++){const s=Math.random()*Math.PI*2,i=6;t.projectiles.push(new et(this.x,this.y,Math.cos(s)*i,Math.sin(s)*i,this.color,1,1.5,20))}this.markedForDeletion=!0;return}super.update(t)}onHitShip(t,e){e.takeDamage(t,this.damage),this.pattern!=="PLASMA"?this.markedForDeletion=!0:t.createExplosion(this.x,this.y,2,this.color)}onHitSerpent(t,e){e.takeDamage(t,this.damage),this.pattern!=="PLASMA"&&(this.markedForDeletion=!0)}drawSpecific(t){if(t.save(),this.pattern==="PLASMA"){const e=Math.sin(Date.now()*.02)*2,s=Te(1,Date.now()*.01,2);K(t,{color:this.color,intensity:s,blur:30}),t.beginPath(),t.arc(0,0,this.size+e,0,Math.PI*2),t.fillStyle=this.color,t.fill()}else this.pattern==="FLAK"?(K(t,{color:this.color,intensity:1,blur:20}),t.beginPath(),t.arc(0,0,this.size,0,Math.PI*2),t.fillStyle=this.color,t.fill()):(K(t,{color:this.color,intensity:.8,blur:15}),t.beginPath(),t.arc(0,0,this.size,0,Math.PI*2),t.fillStyle=this.color,t.fill());t.restore()}}class ke extends X{config={cooldown:150,damage:.5,speed:3,spread:0,color:"#8b5cf6",size:8};icon="ðŸŸ£";duration=900;spawnProjectiles(t,e,s,i){const a=e.vx+Math.cos(s)*this.config.speed,r=e.vy+Math.sin(s)*this.config.speed;t.projectiles.push(new Pt(e.x,e.y,a,r,this.config.color,this.config.damage*i,this.config.size,"PLASMA"))}generateVisual(t,e){const s=V.createCanvas(t,e),i=s.getContext("2d");i.save();const a=t/2,r=e/2,n=8,l=i.createRadialGradient(a,r,0,a,r,n);return l.addColorStop(0,"#ffffff"),l.addColorStop(.5,"#8b5cf6"),l.addColorStop(1,"transparent"),i.fillStyle=l,i.shadowColor="#8b5cf6",i.shadowBlur=30,i.beginPath(),i.arc(a,r,n,0,Math.PI*2),i.fill(),i.restore(),{canvas:s,width:t,height:e,key:"plasma"}}}class Le extends X{config={cooldown:90,damage:2,speed:9,spread:.1,color:"#64748b",size:3};icon="ðŸ’¥";duration=550;spawnProjectiles(t,e,s,i){const a=(Math.random()-.5)*this.config.spread,r=e.vx+Math.cos(s+a)*this.config.speed,n=e.vy+Math.sin(s+a)*this.config.speed;t.projectiles.push(new Pt(e.x,e.y,r,n,this.config.color,this.config.damage*i,this.config.size,"FLAK"))}generateVisual(t,e){const s=V.createCanvas(t,e),i=s.getContext("2d");i.save();const a=t/2,r=e/2;i.fillStyle="#64748b",i.shadowColor="#64748b",i.shadowBlur=22,i.beginPath(),i.arc(a,r,3,0,Math.PI*2),i.fill();for(let n=0;n<6;n++){const l=Math.PI*2*n/6;i.beginPath(),i.moveTo(a,r),i.lineTo(a+Math.cos(l)*5,r+Math.sin(l)*5),i.stroke()}return i.restore(),{canvas:s,width:t,height:e,key:"flak"}}}class Ge extends X{config={cooldown:25,damage:1.5,speed:7,spread:0,color:"#14b8a6",size:2};icon="ã€°ï¸";duration=450;spawnProjectiles(t,e,s,i){const a=e.vx+Math.cos(s)*this.config.speed,r=e.vy+Math.sin(s)*this.config.speed;t.projectiles.push(new Pt(e.x,e.y,a,r,this.config.color,this.config.damage*i,this.config.size,"WAVE"))}generateVisual(t,e){const s=V.createCanvas(t,e),i=s.getContext("2d");i.save(),i.strokeStyle="#14b8a6",i.shadowColor="#14b8a6",i.shadowBlur=18,i.lineWidth=2,i.beginPath();const a=t/2,r=e/2;for(let n=0;n<20;n++){const l=r+Math.sin(n*.5)*3;n===0?i.moveTo(a+n,l):i.lineTo(a+n,l)}return i.stroke(),i.restore(),{canvas:s,width:t,height:e,key:"wave"}}}class Be extends X{config={cooldown:180,damage:15,speed:60,spread:0,color:"#ffffff",size:2};icon="ðŸŽ¯";duration=1e3;getRange(t){return 1e3}spawnProjectiles(t,e,s,i){const a=e.vx+Math.cos(s)*this.config.speed,r=e.vy+Math.sin(s)*this.config.speed;t.projectiles.push(new et(e.x,e.y,a,r,this.config.color,this.config.damage*i,this.config.size,30))}generateVisual(t,e){const s=V.createCanvas(t,e),i=s.getContext("2d");return i.save(),i.strokeStyle="#ffffff",i.shadowColor="#ffffff",i.shadowBlur=30,i.lineWidth=2,i.beginPath(),i.moveTo(t/2,e/2),i.lineTo(t/2-40,e/2),i.stroke(),i.beginPath(),i.arc(t/2-20,e/2,2,0,Math.PI*2),i.fill(),i.restore(),{canvas:s,width:t,height:e,key:"sniper"}}}class Y extends z{type;icon;weight;isGood=!0;weaponClass;constructor(t,e,s,i){super(),this.type=t,this.weaponClass=e,this.icon=s,this.weight=i}get duration(){return new this.weaponClass().duration}apply(t){if(t.weapon!==void 0&&t.weaponTimer!==void 0){const e=new this.weaponClass;t.weapon=e,t.weaponTimer=this.duration}}}const I=class I{static create(t){return this.upgrades.get(t)||null}static apply(t,e){const s=this.create(t);s&&s.apply(e)}};Ot(I,"upgrades",new Map),I.upgrades.set("HEAL",new ge),I.upgrades.set("SPEED_BOOST",new xe),I.upgrades.set("DAMAGE_BOOST",new ye),I.upgrades.set("RAPID_FIRE",new ve),I.upgrades.set("SLOW_DOWN",new me),I.upgrades.set("WEAPON_JAM",new we),I.upgrades.set("SIZE_UP",new be),I.upgrades.set("SIZE_DOWN",new Me),I.upgrades.set("GET_SHIELD",new Se),I.upgrades.set("GET_TELEPORT",new Ee),I.upgrades.set("UPGRADE_BOMB",new Re),I.upgrades.set("UPGRADE_RANGE",new Pe),I.upgrades.set("GET_MINIGUN",new Y("GET_MINIGUN",De,"âˆ´",5)),I.upgrades.set("GET_SHOTGUN",new Y("GET_SHOTGUN",Ae,"â‹—",5)),I.upgrades.set("GET_RAILGUN",new Y("GET_RAILGUN",Ce,"â”",4)),I.upgrades.set("GET_MISSILE",new Y("GET_MISSILE",Oe,"ðŸš€",4)),I.upgrades.set("GET_PLASMA",new Y("GET_PLASMA",ke,"ðŸŸ£",4)),I.upgrades.set("GET_FLAK",new Y("GET_FLAK",Le,"ðŸ’¥",4)),I.upgrades.set("GET_WAVE",new Y("GET_WAVE",Ge,"ã€°ï¸",3)),I.upgrades.set("GET_SNIPER",new Y("GET_SNIPER",Be,"ðŸŽ¯",3));let U=I;class gt extends W{life=1;angle;speed;segments=[];wobbleOffset=Math.random()*100;hp=30;maxHp=30;activeEffects=[];statusIcons=[];sizeMult=1;navTarget=null;targetType=null;damageMult=1;speedMult=1;constructor(t,e){const s=u.randomRange(250,300);super(t,e,`hsla(${s}, 100%, 70%, 1)`),this.angle=Math.random()*Math.PI*2,this.speed=u.randomRange(1.5,2.5),this.segments.push({x:t,y:e})}applyPowerUp(t){if(t.type.startsWith("GET_")&&t.type!=="GET_SHIELD"&&t.type!=="GET_TELEPORT"){U.apply("DAMAGE_BOOST",this);return}U.apply(t.type,this)}get bounty(){let t=50;return this.sizeMult>1.2&&(t*=2),this.activeEffects.length>0&&(t+=25*this.activeEffects.length),Math.floor(t)}takeDamage(t,e=1){const s=this.sizeMult>1.5?e*.7:e;if(this.hp-=s,t.spawnDamageText(this.x,this.y,s,s>5),t.createExplosion(this.x,this.y,5,this.color),this.hp<=0){t.createExplosion(this.x,this.y,60,"#ffffff");const i=this.bounty;t.addCoins(i,this.x,this.y),this.markedForDeletion=!0}}findTarget(t){let e=1/0,s=null,i=null;for(const a of t.powerUps){if(!a.isGood)continue;const r=u.dist(this,a);r<e&&r<400&&(e=r,s=a,i=j.POWERUP)}for(const a of t.ships){const r=u.dist(this,a);r<e&&r<800&&(e=r,s=a,i=j.SHIP)}return s?(this.navTarget={x:s.x,y:s.y},this.targetType=i,s):(this.navTarget=null,this.targetType=null,null)}update(t){const e=t.blackHole,s=u.dist(this,e);if(rt.shouldDieFromShockwave(this,e)){this.takeDamage(t,9999);return}this.speedMult=1,this.sizeMult=1,this.damageMult=1;for(let h=this.activeEffects.length-1;h>=0;h--){const c=this.activeEffects[h];if(!c){this.activeEffects.splice(h,1);continue}c.timer--;const d=U.create(c.type);d&&d.updateEffect&&d.updateEffect(this,c),c.timer<=0&&(this.activeEffects.splice(h,1),d&&d.removeEffect&&d.removeEffect(this))}const i=this.findTarget(t);if(i){const h=u.angle(this,i);let c=u.normalizeAngle(h-this.angle);this.angle+=Math.sign(c)*Math.min(Math.abs(c),.05),this.speed=3*this.speedMult,this.targetType==="SHIP"&&u.dist(this,i)<30*this.sizeMult&&(i.takeDamage(t,2*this.damageMult),this.angle+=Math.PI),this.targetType===j.POWERUP&&u.dist(this,i)<30*this.sizeMult&&(this.applyPowerUp(i),i.markedForDeletion=!0,t.createExplosion(this.x,this.y,10,i.color))}else{if(s>400){const h=u.angle(this,e);let c=u.normalizeAngle(h-this.angle);this.angle+=Math.sign(c)*Math.min(Math.abs(c),.02)}this.speed=2*this.speedMult}this.x+=Math.cos(this.angle)*this.speed,this.y+=Math.sin(this.angle)*this.speed;const a=Math.sin(Date.now()*.005+this.wobbleOffset)*(3*this.sizeMult),r=this.x+Math.cos(this.angle+Math.PI/2)*a,n=this.y+Math.sin(this.angle+Math.PI/2)*a;this.segments.unshift({x:r,y:n});const l=40*this.sizeMult;this.segments.length>l&&this.segments.pop(),s>900&&(this.life-=.01),this.life<=0&&(this.markedForDeletion=!0)}}class Vt extends W{life=1;size;constructor(t,e,s,i,a,r){super(t,e,s),this.size=i,this.vx=a,this.vy=r}update(){this.x+=this.vx,this.y+=this.vy,this.life-=.02,this.life<=0&&(this.markedForDeletion=!0)}}class Yt extends yt{target;trail=[];fuel=100;constructor(t,e,s,i,a,r){super(t,e,s,i,a,r,4,200)}update(t){if(!this.target||this.target.markedForDeletion){let e=1/0;for(const s of t.ships){if(s.color===this.color)continue;const i=u.dist(this,s);i<e&&i<800&&(e=i,this.target=s)}if(!this.target)for(const s of t.serpents){const i=u.dist(this,s);i<e&&i<800&&(e=i,this.target=s)}}if(this.target&&this.fuel>0){const e=this.target instanceof gt&&this.target.segments.length>0&&this.target.segments[0]?this.target.segments[0].x:this.target.x,s=this.target instanceof gt&&this.target.segments.length>0&&this.target.segments[0]?this.target.segments[0].y:this.target.y,i=Math.atan2(s-this.y,e-this.x),a=Math.atan2(this.vy,this.vx);let r=u.normalizeAngle(i-a);const n=.08*t.warpFactor,l=a+Math.sign(r)*Math.min(Math.abs(r),n),h=Math.hypot(this.vx,this.vy);this.vx=Math.cos(l)*h*1.02,this.vy=Math.sin(l)*h*1.02;const c=12,d=Math.hypot(this.vx,this.vy);d>c&&(this.vx=this.vx/d*c,this.vy=this.vy/d*c),this.fuel--,Math.random()<.4&&t.particles.push(new Vt(this.x,this.y,"#555",u.randomRange(1,3),0,0))}this.trail.push({x:this.x,y:this.y}),this.trail.length>15&&this.trail.shift(),super.update(t)}createHitEffect(t){t.createExplosion(this.x,this.y,20,"#fbbf24"),t.spawnShockwave(this.x,this.y),this.markedForDeletion=!0}drawSpecific(t){if(t.rotate(-Math.atan2(this.vy,this.vx)),this.trail.length>1&&this.trail[0]){t.save(),t.strokeStyle="#9ca3af",t.shadowColor="#9ca3af",t.shadowBlur=8,t.lineWidth=1,t.beginPath(),t.moveTo(this.trail[0].x-this.x,this.trail[0].y-this.y);for(const e of this.trail)e&&t.lineTo(e.x-this.x,e.y-this.y);t.stroke(),t.restore()}t.rotate(Math.atan2(this.vy,this.vx)),t.save(),t.fillStyle=this.color,t.shadowColor=this.color,t.shadowBlur=20,t.beginPath(),t.moveTo(6,0),t.lineTo(-4,4),t.lineTo(-4,-4),t.fill(),t.restore(),t.save(),t.strokeStyle="#f59e0b",t.shadowColor="#f59e0b",t.shadowBlur=15,t.lineWidth=2,t.beginPath(),t.moveTo(-4,0),t.lineTo(-8,0),t.stroke(),t.restore()}}class Ne{ctx;constructor(t){this.ctx=t}clear(t,e,s,i,a){if(i){if(a<100){this.ctx.fillStyle="#ffffff",this.ctx.fillRect(0,0,t,e);return}this.ctx.fillStyle=x.COLORS.bg,this.ctx.fillRect(0,0,t,e)}else this.ctx.fillStyle=`rgba(10, 10, 10, ${.3+1/s*.7})`,this.ctx.fillRect(0,0,t,e)}drawBlackHole(t){if(t.state===T.EXPLODING){this.ctx.beginPath(),this.ctx.arc(t.x,t.y,t.shockwaveRadius,0,Math.PI*2),this.ctx.strokeStyle="#ffffff",this.ctx.lineWidth=15,this.ctx.globalAlpha=Math.max(0,1-t.shockwaveRadius/2e3),this.ctx.stroke(),this.ctx.globalAlpha=1;return}const e=t.safetyTimer>0?.5:1,s=this.ctx.createRadialGradient(t.x,t.y,t.visualRadius*.8,t.x,t.y,t.visualRadius*2.5),i=t.state===T.UNSTABLE?x.COLORS.danger:x.COLORS.primary;s.addColorStop(0,i),s.addColorStop(1,"rgba(0,0,0,0)"),this.ctx.globalAlpha=e*.6,this.ctx.fillStyle=s,this.ctx.beginPath(),this.ctx.arc(t.x,t.y,t.visualRadius*3,0,Math.PI*2),this.ctx.fill(),this.ctx.globalAlpha=1*e,this.drawAccretionDisk(t),this.drawBlackHoleCore(t)}drawBlackHoleCore(t){if(this.ctx.save(),this.ctx.translate(t.x,t.y),t.shake>0){const a=t.shake*.5;this.ctx.translate(u.randomRange(-a,a),u.randomRange(-a,a))}const e=t.visualRadius,s=t.state===T.UNSTABLE?"#ef4444":"#8b5cf6";this.ctx.beginPath(),this.ctx.arc(0,0,e,0,Math.PI*2),this.ctx.fillStyle="#000000",this.ctx.fill(),this.ctx.beginPath(),this.ctx.arc(0,0,e*.95,0,Math.PI*2),this.ctx.strokeStyle="#ffffff",this.ctx.lineWidth=2,this.ctx.shadowBlur=10,this.ctx.shadowColor=s,this.ctx.stroke(),this.ctx.shadowBlur=0;const i=this.ctx.createRadialGradient(0,0,0,0,0,e*.9);i.addColorStop(0,"#000000"),i.addColorStop(.6,"rgba(0,0,0,0.8)"),i.addColorStop(1,s),this.ctx.globalAlpha=.3,this.ctx.fillStyle=i,this.ctx.fill(),this.ctx.globalAlpha=1,this.ctx.restore()}drawAccretionDisk(t){if(this.ctx.save(),this.ctx.translate(t.x,t.y),t.shake>0){const s=t.shake*.5;this.ctx.translate(u.randomRange(-s,s),u.randomRange(-s,s))}this.ctx.rotate(Date.now()*2e-4);const e=t.state===T.UNSTABLE?x.COLORS.danger:x.COLORS.primary;for(let s=1;s<=3;s++){const i=t.visualRadius+s*20,a=4+s*2;this.ctx.beginPath(),this.ctx.arc(0,0,i,0,Math.PI*2),this.ctx.strokeStyle=e,this.ctx.lineWidth=1,this.ctx.globalAlpha=.1,this.ctx.stroke();for(let r=0;r<a;r++){const n=Math.PI*2*r/a+Date.now()*.001*(.5/s)*(s%2===0?1:-1);this.ctx.beginPath(),this.ctx.arc(Math.cos(n)*i,Math.sin(n)*i,4,0,Math.PI*2),this.ctx.fillStyle=e,this.ctx.globalAlpha=.8,this.ctx.fill()}}this.ctx.restore()}drawMeteor(t,e){if(t.trail.length>1){const s=t.trail[0];if(s){this.ctx.beginPath(),this.ctx.moveTo(s.x,s.y);for(const i of t.trail)i&&this.ctx.lineTo(i.x,i.y);this.ctx.strokeStyle=t.color,this.ctx.lineWidth=t.isDebris?2:1.5,this.ctx.globalAlpha=t.isDebris?.8:.4,this.ctx.stroke(),this.ctx.globalAlpha=1}}this.ctx.beginPath(),this.ctx.arc(t.x,t.y,t.size,0,Math.PI*2),this.ctx.fillStyle=t.color,t.gravityFactor<0&&(this.ctx.shadowBlur=8,this.ctx.shadowColor=t.color),this.ctx.fill(),this.ctx.shadowBlur=0}drawShip(t){if(t.navTarget&&t.state!==F.PANIC&&(this.ctx.beginPath(),this.ctx.moveTo(t.x,t.y),this.ctx.lineTo(t.navTarget.x,t.navTarget.y),this.ctx.strokeStyle="rgba(255,255,255,0.1)",this.ctx.setLineDash([3,3]),this.ctx.stroke(),this.ctx.setLineDash([])),this.ctx.save(),this.ctx.translate(t.x,t.y),this.ctx.rotate(t.angle),this.ctx.scale(t.sizeMult,t.sizeMult),t.shield>0&&(this.ctx.beginPath(),this.ctx.arc(0,0,14,0,Math.PI*2),this.ctx.strokeStyle=`rgba(59, 130, 246, ${t.shield/t.maxShield})`,this.ctx.lineWidth=1,this.ctx.stroke()),t.thrustPower>.1){const l=Math.random()*.4+.8,h=t.state===F.PANIC?180:80,c=t.thrustPower*h*l*.02;this.ctx.beginPath(),this.ctx.moveTo(-6,-2),this.ctx.lineTo(-6-c*20,0),this.ctx.lineTo(-6,2),this.ctx.fillStyle=t.state===F.PANIC?"#ef4444":x.COLORS.shipEngines,this.ctx.fill()}this.ctx.save(),K(this.ctx,{color:t.color,intensity:1,blur:20}),this.ctx.fillStyle=t.color,this.ctx.beginPath();const e=t.visualConfig.points;if(e&&e.length>0){const l=e[0];if(l){this.ctx.moveTo(l.x,l.y);for(let h=1;h<e.length;h++){const c=e[h];c&&this.ctx.lineTo(c.x,c.y)}this.ctx.closePath()}}else this.ctx.moveTo(10,0),this.ctx.lineTo(-6,6),this.ctx.lineTo(-4,0),this.ctx.lineTo(-6,-6);this.ctx.fill(),this.ctx.strokeStyle="#fff",this.ctx.lineWidth=1,this.ctx.stroke();const s=t.visualConfig;if(s.hasCockpit&&(this.ctx.fillStyle="rgba(255, 255, 255, 0.3)",this.ctx.beginPath(),this.ctx.arc(s.length*.3,0,2,0,Math.PI*2),this.ctx.fill()),s.hasWings){const l=s.width*s.wingSize;this.ctx.strokeStyle=t.color,this.ctx.lineWidth=1.5,this.ctx.beginPath(),this.ctx.moveTo(-s.length*.2,s.width*.5),this.ctx.lineTo(-s.length*.4,s.width*.5+l),this.ctx.lineTo(-s.length*.3,s.width*.5),this.ctx.moveTo(-s.length*.2,-s.width*.5),this.ctx.lineTo(-s.length*.4,-s.width*.5-l),this.ctx.lineTo(-s.length*.3,-s.width*.5),this.ctx.stroke()}s.hasAntenna&&(this.ctx.strokeStyle=t.color,this.ctx.lineWidth=1,this.ctx.beginPath(),this.ctx.moveTo(s.length*.8,0),this.ctx.lineTo(s.length*.9,-1),this.ctx.stroke()),this.ctx.restore(),this.ctx.restore(),this.ctx.save(),this.ctx.translate(t.x,t.y);const i=-18*t.sizeMult,a=20;if(t.hp<t.maxHp&&(this.ctx.fillStyle="rgba(0,0,0,0.6)",this.ctx.fillRect(-a/2,i-3,a,3),this.ctx.fillStyle="#00ff00",this.ctx.fillRect(-a/2,i-3,a*(t.hp/t.maxHp),3)),t.weapon&&t.weapon.cooldownTimer>0){const l=t.weapon.config.cooldown,h=Math.max(0,1-t.weapon.cooldownTimer/l);this.ctx.fillStyle="rgba(0,0,0,0.6)",this.ctx.fillRect(-a/2,i+1,a,2),this.ctx.fillStyle="#fbbf24",this.ctx.fillRect(-a/2,i+1,a*h,2)}const r=i-10;this.ctx.font="10px monospace",this.ctx.textAlign="center",this.ctx.fillStyle="#ffffff";let n="";t.weapon.icon&&(n+=t.weapon.icon),n+=t.statusIcons.join(""),n&&this.ctx.fillText(n,0,r),this.ctx.restore()}drawPowerUp(t){this.ctx.save(),this.ctx.translate(t.x,t.y);const e=1+Math.sin(t.pulse)*.2;this.ctx.scale(e,e),this.ctx.shadowBlur=15,this.ctx.shadowColor=t.color,this.ctx.beginPath(),this.ctx.arc(0,0,8,0,Math.PI*2),this.ctx.strokeStyle=t.color,this.ctx.lineWidth=2,this.ctx.stroke(),this.ctx.fillStyle=t.color,this.ctx.font="12px monospace",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.shadowBlur=0;const s=U.create(t.type),i=s?s.getIcon():"?";this.ctx.fillText(i,0,1),this.ctx.restore()}drawProjectile(t){this.ctx.save(),this.ctx.translate(t.x,t.y),t.drawSpecific(this.ctx),t instanceof Yt&&t.fuel>0&&(this.ctx.rotate(0),this.ctx.fillStyle="#555",this.ctx.fillRect(-5,-10,10,2),this.ctx.fillStyle="#f59e0b",this.ctx.fillRect(-5,-10,10*(t.fuel/100),2)),this.ctx.restore()}drawParticle(t){const e=Math.max(0,t.size*t.life);this.ctx.beginPath(),this.ctx.arc(t.x,t.y,e,0,Math.PI*2),this.ctx.fillStyle=t.color,this.ctx.globalAlpha=t.life,this.ctx.fill(),this.ctx.globalAlpha=1}drawStars(t,e){for(let s=0;s<t.length;s++){const i=t[s];if(i){if(this.ctx.beginPath(),this.ctx.arc(i.x,i.y,2,0,Math.PI*2),this.ctx.fillStyle=i.color,this.ctx.fill(),e>1.1){const a=i.x-window.innerWidth/2,r=i.y-window.innerHeight/2,n=Math.sqrt(a*a+r*r)||1;this.ctx.beginPath(),this.ctx.moveTo(i.x,i.y),this.ctx.lineTo(i.x-a/n*20*(e-1),i.y-r/n*20*(e-1)),this.ctx.strokeStyle="rgba(139, 92, 246, 0.5)",this.ctx.lineWidth=2,this.ctx.stroke()}else if(e<1.2)for(let a=s+1;a<t.length;a++){const r=t[a];if(!r)continue;const n=u.dist(i,r);n<150&&(this.ctx.beginPath(),this.ctx.moveTo(i.x,i.y),this.ctx.lineTo(r.x,r.y),this.ctx.strokeStyle=`rgba(139, 92, 246, ${(1-n/150)*.25})`,this.ctx.lineWidth=1,this.ctx.stroke())}}}}drawVoidSerpent(t){if(t.navTarget&&(this.ctx.beginPath(),this.ctx.moveTo(t.x,t.y),this.ctx.lineTo(t.navTarget.x,t.navTarget.y),this.ctx.strokeStyle="rgba(139, 92, 246, 0.3)",this.ctx.lineWidth=1,this.ctx.setLineDash([2,2]),this.ctx.stroke(),this.ctx.setLineDash([])),t.segments.length<2)return;const e=t.segments[0];if(!e)return;this.ctx.beginPath(),this.ctx.moveTo(e.x,e.y);for(let a=1;a<t.segments.length-1;a++){const r=t.segments[a],n=t.segments[a+1];if(!r||!n)continue;const l=(r.x+n.x)/2,h=(r.y+n.y)/2;this.ctx.quadraticCurveTo(r.x,r.y,l,h)}this.ctx.save(),K(this.ctx,{color:t.color,intensity:t.life,blur:25}),this.ctx.strokeStyle=t.color;const s=Math.max(0,3*t.life*t.sizeMult);this.ctx.lineWidth=s,this.ctx.lineCap="round",this.ctx.globalAlpha=Math.max(0,Math.min(1,t.life)),s>0&&this.ctx.stroke(),this.ctx.restore();const i=Math.max(0,4*t.life*t.sizeMult);i>0&&(this.ctx.save(),K(this.ctx,{color:"#ffffff",intensity:t.life,blur:20}),this.ctx.beginPath(),this.ctx.arc(e.x,e.y,i,0,Math.PI*2),this.ctx.fillStyle="#ffffff",this.ctx.fill(),this.ctx.restore()),this.ctx.save(),this.ctx.translate(e.x,e.y),this.ctx.fillStyle="rgba(255,0,0,0.5)",this.ctx.fillRect(-15,-20,30,3),this.ctx.fillStyle="#00ff00",this.ctx.fillRect(-15,-20,30*(t.hp/t.maxHp),3),this.ctx.restore(),this.ctx.globalAlpha=1,this.ctx.shadowBlur=0}}class ze{segments=[];active=!1;life=0;generate(t,e,s,i){this.segments=[],this.active=!0,this.life=1;const a=Math.floor(u.randomRange(5,12)),r=Math.random()*Math.PI*2;for(let n=0;n<a;n++){let l=r+Math.PI*2*n/a+u.randomRange(-.4,.4),h=t,c=e;const d=Math.max(s,i)*u.randomRange(.5,.9);let p=0;for(;p<d;){const b=u.randomRange(40,120);l+=u.randomRange(-.6,.6);const y=h+Math.cos(l)*b,v=c+Math.sin(l)*b;if(this.segments.push({x1:h,y1:c,x2:y,y2:v,width:Math.max(1,6-p/150),alpha:u.randomRange(.4,1)}),Math.random()<.3){const D=l+u.randomRange(.5,1.5)*(Math.random()>.5?1:-1),E=u.randomRange(30,60);this.segments.push({x1:h,y1:c,x2:h+Math.cos(D)*E,y2:c+Math.sin(D)*E,width:1,alpha:.5})}h=y,c=v,p+=b}}}update(t){this.active&&(t?this.life-=.015:this.life=1-Math.random()*.1,this.life<=0&&(this.active=!1,this.segments=[]))}draw(t){if(this.active){t.save(),t.lineCap="round",t.strokeStyle="#a5f3fc",t.beginPath();for(let e=0;e<this.segments.length;e++){const s=this.segments[e];s&&this.life*s.alpha>.05&&(t.lineWidth=s.width*this.life,t.moveTo(s.x1,s.y1),t.lineTo(s.x2,s.y2))}t.globalAlpha=this.life,t.stroke(),t.restore()}}}class wt{update(t,e){t.mass>=x.CRITICAL_MASS&&t.setState(T.UNSTABLE)}}class $e{update(t,e){const s=e.warpFactor;t.shake+=.8*s,t.shake>120&&(t.setState(T.EXPLODING),t.shockwaveRadius=1,e.spawnSupernovaDebris())}}class Fe{update(t,e){const s=e.warpFactor;t.shockwaveRadius+=25*s,t.shake=0,t.shockwaveRadius>Math.max(e.width,e.height)*1.5&&(t.setState(T.REFORMING),t.mass=0,t.safetyTimer=200,e.initStars())}}class Ue{update(t,e){const s=e.warpFactor;t.radius>x.START_RADIUS+1?t.radius-=1*s:t.setState(T.STABLE)}}class He extends W{mass=0;radius=x.START_RADIUS;visualRadius=x.START_RADIUS;pulse=0;state=T.STABLE;shake=0;shockwaveRadius=0;safetyTimer=0;currentState=new wt;states=new Map([[T.STABLE,new wt],[T.UNSTABLE,new $e],[T.EXPLODING,new Fe],[T.REFORMING,new Ue]]);constructor(t,e){super(t,e,"#000000")}setState(t){this.state=t,this.currentState=this.states.get(t)||new wt}update(t){const e=t.warpFactor;this.pulse+=.05*e;const s=this.mass/x.CRITICAL_MASS,i=x.START_RADIUS+s*80;this.radius+=(i-this.radius)*.05*e,this.visualRadius=this.radius+Math.sin(this.pulse)*2,this.safetyTimer>0&&this.safetyTimer--,this.state!==T.UNSTABLE&&this.shake>0&&(this.shake*=.9),this.currentState.update(this,t)}}class je extends W{constructor(t,e){super(t,e,"rgba(139, 92, 246, 0.6)"),this.vx=u.randomRange(-.5,.5),this.vy=u.randomRange(-.5,.5)}update(t){if(t.warpFactor>1.1){const e=this.x-t.width/2,s=this.y-t.height/2,i=Math.sqrt(e*e+s*s)||1;this.x+=e/i*2*t.warpFactor,this.y+=s/i*2*t.warpFactor}else if(t.blackHole.state===T.EXPLODING){const e=t.blackHole,s=u.dist(this,e);if(s<e.shockwaveRadius+100&&s>e.shockwaveRadius-50){const i=u.angle(e,this);this.vx+=Math.cos(i)*5,this.vy+=Math.sin(i)*5}}this.applyPhysics(1,.95),(this.x<0||this.x>t.width||this.y<0||this.y>t.height)&&(t.warpFactor>1.1?(this.x=t.width/2+u.randomRange(-50,50),this.y=t.height/2+u.randomRange(-50,50)):(this.vx*=-1,this.vy*=-1))}}class Bt extends W{size;trail=[];isDebris;gravityFactor;friction;label;constructor(t,e,s,i,a,r){const n=!a&&Math.random()>.85,l=n?x.COLORS.repel:Math.random()>.6?x.COLORS.secondary:x.COLORS.white,h=u.randomChoice([x.COLORS.white,x.COLORS.primary,x.COLORS.secondary,x.COLORS.danger]);super(t,e,a?h:l),this.vx=s,this.vy=i,this.isDebris=a,this.label=r,this.size=r?4:u.randomRange(2,5),this.gravityFactor=a?-1.5:n?-2:4,this.friction=a?.98:1}update(t){const e=t.blackHole,s=u.dist(this,e),i=u.angle(this,e);if(e.state===T.EXPLODING)s<e.shockwaveRadius+50&&s>e.shockwaveRadius-100&&(this.vx-=Math.cos(i)*5,this.vy-=Math.sin(i)*5,this.isDebris&&(this.vx-=Math.cos(i)*2,this.vy-=Math.sin(i)*2));else{if(e.safetyTimer===0&&s<e.visualRadius){t.createExplosion(this.x,this.y,5,this.color),e.mass+=x.MASS_GAIN_METEOR,this.markedForDeletion=!0;return}const n=.4+e.mass/x.CRITICAL_MASS*.6,l=x.GRAVITY_RADIUS_BASE*(.5+n*.5);if(s<l){const h=1-s/l,d=(this.gravityFactor>0?2.5*(h*h):.5*h)*this.gravityFactor*t.warpFactor*n,p=(this.gravityFactor>0?.05:.1)*t.warpFactor;this.vx+=Math.cos(i)*d+Math.cos(i+Math.PI/2)*p,this.vy+=Math.sin(i)*d+Math.sin(i+Math.PI/2)*p,this.gravityFactor>0&&s<350&&(this.vx*=.96,this.vy*=.96)}}this.vx*=this.friction,this.vy*=this.friction;const a=t.warpFactor>1.1?t.warpFactor*.5:1;this.x+=this.vx*a,this.y+=this.vy*a,this.trail.push({x:this.x,y:this.y});const r=(this.isDebris?8:14)*t.warpFactor;this.trail.length>r&&this.trail.shift(),(this.x<-500||this.x>t.width+500||this.y<-500||this.y>t.height+500)&&(this.markedForDeletion=!0)}}class Nt{static getAvoidanceVector(t,e,s){let i=0,a=0;for(const r of e){if(r===t)continue;const n=u.dist(t,r);if(n<s&&n>0){const l=1-n/s;i-=(r.x-t.x)/n*l,a-=(r.y-t.y)/n*l}}return{x:i,y:a}}static getPathToTarget(t,e,s){const i=u.angle(t,e);if(t.state===F.PANIC)return u.angle(s,t);const a=u.dist(t,s),r=u.dist(t,e),n=u.angle(t,s),l=Math.abs(u.normalizeAngle(i-n));if(s.state!==T.EXPLODING&&a<r&&l<.8&&a<500){const h=u.normalizeAngle(n-t.angle)>0?-1:1;return n+Math.PI/2*h}return i}}class Mt extends X{config={cooldown:40,damage:1,speed:12,spread:.05,color:null,size:2};icon="";duration=600;spawnProjectiles(t,e,s,i){const a=(Math.random()-.5)*this.config.spread,r=e.vx+Math.cos(s+a)*this.config.speed,n=e.vy+Math.sin(s+a)*this.config.speed;t.projectiles.push(new et(e.x,e.y,r,n,e.color,this.config.damage*i,this.config.size,60))}generateVisual(t,e){const s=V.createCanvas(t,e),i=s.getContext("2d");return i.save(),i.strokeStyle="#8b5cf6",i.shadowColor="#8b5cf6",i.shadowBlur=15,i.lineWidth=2,i.beginPath(),i.moveTo(t/2,e/2),i.lineTo(t/2-20,e/2),i.stroke(),i.restore(),{canvas:s,width:t,height:e,key:"blaster"}}}const w=Tt({coins:0,shipsCount:4,damageLevel:1,hullLevel:1,turretSpeed:1,shieldLevel:0,critLevel:0,regenLevel:0,magnetLevel:1}),C=H(()=>{const o=(t,e,s)=>Math.floor(t*Math.pow(e,s));return{ship:o(1e3,2.2,w.shipsCount-4),damage:o(250,1.4,w.damageLevel-1),turret:o(300,1.45,w.turretSpeed-1),hull:o(200,1.35,w.hullLevel-1),shield:o(400,1.4,w.shieldLevel),crit:o(500,1.6,w.critLevel),regen:o(600,1.6,w.regenLevel),magnet:o(300,1.5,w.magnetLevel-1)}}),J=o=>{const t=C.value[o];w.coins>=t&&(w.coins-=t,o==="ship"?(w.shipsCount++,x.SHIP_COUNT=w.shipsCount):o==="damage"?w.damageLevel++:o==="hull"?w.hullLevel++:o==="turret"?w.turretSpeed++:o==="shield"?w.shieldLevel++:o==="crit"?w.critLevel++:o==="regen"?w.regenLevel++:o==="magnet"&&w.magnetLevel++)};class Z{static getDamageMultiplier(){return 1+(w.damageLevel-1)*.2}static getReloadMultiplier(){return 1+(w.turretSpeed-1)*.15}static getRegenRate(){return Math.max(60,360-w.regenLevel*60)}static getRegenLevel(){return w.regenLevel}static getCritLevel(){return w.critLevel}static getHullLevel(){return w.hullLevel}static getShieldLevel(){return w.shieldLevel}}class It{static instance=null;static getInstance(){return this.instance||(this.instance=new It),this.instance}updateRegen(t,e){if(Z.getRegenLevel()===0||t.hp===void 0||t.maxHp===void 0||t.hp>=t.maxHp)return!1;e.value++;const s=Z.getRegenRate();return e.value>s?(t.hp++,e.value=0,!0):!1}}class We{static calculateCritDamage(t,e){const i=(e??Z.getCritLevel())*.05;return Math.random()<i?{damage:t*2,isCrit:!0}:{damage:t,isCrit:!1}}}var St=(o=>(o.TRIANGLE="TRIANGLE",o.ARROW="ARROW",o.DIAMOND="DIAMOND",o.FIGHTER="FIGHTER",o.INTERCEPTOR="INTERCEPTOR",o.SCOUT="SCOUT",o.CRUISER="CRUISER",o.BOMBER="BOMBER",o))(St||{}),Et=(o=>(o.SHARP="SHARP",o.ROUNDED="ROUNDED",o.ANGULAR="ANGULAR",o))(Et||{});class Xe{static seedCounter=0;static generate(t){const e=this.createRNG(t),s=Object.values(St),i=s[Math.floor(e()*s.length)],a=Object.values(Et),r=a[Math.floor(e()*a.length)],n=8+e()*6,l=4+e()*4,h=e(),c=e()>.4,d=e()>.6,p=e()>.7,b=c?.5+e()*.5:0,y=e(),v=this.generateHullPoints(i,r,n,l,h,e);return{hullType:i,style:r,length:n,width:l,noseSharpness:h,hasWings:c,hasCockpit:d,hasAntenna:p,wingSize:b,detailLevel:y,points:v}}static createRNG(t){t===void 0&&(t=Date.now()+this.seedCounter++);let e=t;return()=>(e=(e*9301+49297)%233280,e/233280)}static generateHullPoints(t,e,s,i,a,r){const n=[];switch(t){case"TRIANGLE":n.push({x:s,y:0}),n.push({x:-s*.4,y:i}),n.push({x:-s*.2,y:0}),n.push({x:-s*.4,y:-i});break;case"ARROW":const l=s*(.7+a*.3);n.push({x:l,y:0}),n.push({x:-s*.3,y:i*.8}),n.push({x:-s*.5,y:0}),n.push({x:-s*.3,y:-i*.8});break;case"DIAMOND":n.push({x:s*.6,y:0}),n.push({x:0,y:i}),n.push({x:-s*.6,y:0}),n.push({x:0,y:-i});break;case"FIGHTER":n.push({x:s,y:0}),n.push({x:-s*.2,y:i*1.2}),n.push({x:-s*.4,y:i*.3}),n.push({x:-s*.3,y:0}),n.push({x:-s*.4,y:-i*.3}),n.push({x:-s*.2,y:-i*1.2});break;case"INTERCEPTOR":n.push({x:s*1.2,y:0}),n.push({x:-s*.3,y:i*.6}),n.push({x:-s*.1,y:0}),n.push({x:-s*.3,y:-i*.6});break;case"SCOUT":n.push({x:s*.8,y:0}),n.push({x:-s*.3,y:i*.7}),n.push({x:-s*.2,y:0}),n.push({x:-s*.3,y:-i*.7});break;case"CRUISER":n.push({x:s*.9,y:0}),n.push({x:-s*.1,y:i*1.3}),n.push({x:-s*.3,y:i*.5}),n.push({x:-s*.4,y:0}),n.push({x:-s*.3,y:-i*.5}),n.push({x:-s*.1,y:-i*1.3});break;case"BOMBER":n.push({x:s*.7,y:0}),n.push({x:0,y:i*1.1}),n.push({x:-s*.4,y:i*.8}),n.push({x:-s*.5,y:0}),n.push({x:-s*.4,y:-i*.8}),n.push({x:0,y:-i*1.1});break}return n}static getRandomHullType(){const t=Object.values(St);return t[Math.floor(Math.random()*t.length)]}static getRandomStyle(){const t=Object.values(Et);return t[Math.floor(Math.random()*t.length)]}}class Ve extends W{visualConfig;angle;cooldown=0;bombCooldown=0;thrustPower=0;hp=5;maxHp=5;state=F.ROAM;navTarget=null;targetType=null;wanderTarget=null;combatTimer=0;combatManeuver=st.FLANK;activeEffects=[];statusIcons=[];weapon;weaponTimer=0;shield=0;maxShield=5;hasTeleport=!1;bombLevel=1;rangeMult=1;sizeMult=1;regenTimer=0;speedMult=1;damageMult=1;reloadMult=1;isJammed=!1;constructor(t,e,s){super(t,e,u.randomColor()),this.angle=s,this.weapon=new Mt,this.visualConfig=Xe.generate(),this.maxHp=5+(Z.getHullLevel()-1)*3,this.hp=this.maxHp,this.maxShield=Z.getShieldLevel()*5,this.shield=this.maxShield,this.cooldown=u.randomRange(0,100),this.bombCooldown=u.randomRange(0,500)}applyPowerUp(t){U.apply(t.type,this)}findBestTarget(t){let e=null,s=1/0;for(const l of t.powerUps){if(!l.isGood)continue;const h=u.dist(this,l);h<s&&h<500&&(s=h,e=l)}if(e)return{target:e,type:j.POWERUP};let i=null,a=1/0;for(const l of t.serpents){const h=u.dist(this,l);h<a&&(a=h,i=l)}if(i&&i.segments.length>0){const l=i.segments[0];if(l)return{target:l,type:j.SERPENT}}let r=null,n=1/0;for(const l of t.ships){if(l===this)continue;const h=u.dist(this,l);h<n&&(n=h,r=l)}return r&&n<1e3?{target:r,type:j.SHIP}:((!this.wanderTarget||u.dist(this,this.wanderTarget)<100)&&(this.wanderTarget={x:u.randomRange(100,t.width-100),y:u.randomRange(100,t.height-100)}),{target:this.wanderTarget,type:j.POINT})}update(t){this.speedMult=1,this.damageMult=Z.getDamageMultiplier(),this.reloadMult=Z.getReloadMultiplier(),this.isJammed=!1,this.sizeMult=1;for(let g=this.activeEffects.length-1;g>=0;g--){const A=this.activeEffects[g];if(!A){this.activeEffects.splice(g,1);continue}A.timer--;const S=U.create(A.type);S&&S.updateEffect&&S.updateEffect(this,A),A.timer<=0&&(this.activeEffects.splice(g,1),S&&S.removeEffect&&S.removeEffect(this))}if(this.sizeMult<1&&(this.speedMult*=1.3),this.sizeMult>1&&(this.speedMult*=.8),this.weaponTimer>0&&(this.weaponTimer--,this.weaponTimer<=0&&(this.weapon=new Mt)),this.weapon.update(),this.hasTeleport){const g=U.create("GET_TELEPORT");g&&"tryTeleport"in g&&g.tryTeleport(this,t)}const e=t.blackHole,s=u.dist(this,e),i=u.angle(this,e);if(rt.shouldDieFromShockwave(this,e)){this.die(t);return}if(rt.shouldDieFromGravity(this,e)){e.mass+=x.MASS_GAIN_SHIP,this.die(t);return}const a=rt.calculateGravityPull(this,e);a&&(this.vx+=a.vx,this.vy+=a.vy);const{target:r,type:n}=this.findBestTarget(t);this.navTarget=r,this.targetType=n;let l=this.angle,h=.4;const c=180+e.mass/x.CRITICAL_MASS*200;if(e.state!==T.EXPLODING&&s<c)this.state=F.PANIC,l=u.angle(e,this),h=1;else if(r){const g=u.dist(this,r),A=u.angle(this,r),S=Math.abs(u.normalizeAngle(A-i));if(s<g&&S<.8&&e.state!==T.EXPLODING){const L=u.normalizeAngle(i-this.angle)>0?-1:1;l=i+Math.PI/2*L,this.state=F.ROAM}else if(n===j.SERPENT||n===j.SHIP){this.state=F.DOGFIGHT;const L=u.dist(this,r);this.handleCombat(t,r,L,n===j.SERPENT),l=this.combatManeuverAngle(r,L),h=L>400?.7:.5}else this.state=F.ROAM,l=Nt.getPathToTarget(this,r,e),h=.4}const d=Nt.getAvoidanceVector(this,t.ships,x.SHIP_SEPARATION);this.vx+=d.x*.5,this.vy+=d.y*.5;const p=It.getInstance(),b={value:this.regenTimer};p.updateRegen(this,b)&&t.createExplosion(this.x,this.y,2,"#10b981"),this.regenTimer=b.value;const y=Z.getShieldLevel()*5;this.maxShield<y&&(this.shield+=y-this.maxShield,this.maxShield=y),this.cooldown--,this.bombCooldown--;let v=u.normalizeAngle(l-this.angle);const D=this.state===F.DOGFIGHT?x.SHIP_TURN_SPEED*2:x.SHIP_TURN_SPEED;this.angle+=Math.sign(v)*Math.min(Math.abs(v),D),this.vx+=Math.cos(this.angle)*h,this.vy+=Math.sin(this.angle)*h,this.vx*=.96,this.vy*=.96;const E=Math.hypot(this.vx,this.vy),_=(this.state===F.PANIC?x.SHIP_SPEED*2:x.SHIP_SPEED)*this.speedMult;E>_&&(this.vx=this.vx/E*_,this.vy=this.vy/E*_),this.thrustPower=h;const R=t.warpFactor>1.1?t.warpFactor*.7:1;this.x+=this.vx*R,this.y+=this.vy*R;const M=30;this.x<-M?this.x=t.width+M:this.x>t.width+M&&(this.x=-M),this.y<-M?this.y=t.height+M:this.y>t.height+M&&(this.y=-M)}combatManeuverAngle(t,e){const s=u.angle(this,t);if(this.combatTimer--,this.combatTimer<=0){this.combatTimer=u.randomRange(60,120);const i=Math.random();this.combatManeuver=i<.4?st.CHARGE:i<.8?st.FLANK:st.RETREAT}return this.combatManeuver===st.CHARGE?s:this.combatManeuver===st.RETREAT?s+Math.PI:s+Math.PI/2}handleCombat(t,e,s,i){const a=e.vx||0,r=e.vy||0,n=e.x+a*15,l=e.y+r*15,h=u.angle(this,{x:n,y:l}),c=Math.abs(u.normalizeAngle(h-this.angle));if(this.weapon.isReady&&!this.isJammed){const d=this.weapon.getAllowedAngle(),p=this.weapon.getRange(x.SHIP_ENGAGEMENT_DIST);if(s<p&&c<d){const b=We.calculateCritDamage(this.damageMult);this.weapon.fire(t,this,h,b.damage,this.reloadMult)}}if(this.bombLevel>0&&this.bombCooldown<=0){const d=U.create("UPGRADE_BOMB");d&&"tryFireBomb"in d&&d.tryFireBomb(this,t)}}takeDamage(t,e=1){t.spawnDamageText(this.x,this.y,e,!1),this.shield>0?(this.shield-=e,t.createExplosion(this.x,this.y,5,x.COLORS.shield),this.shield<0&&(this.hp+=this.shield,this.shield=0)):(this.hp-=e,t.createExplosion(this.x,this.y,10,this.color)),this.hp<=0&&this.die(t)}die(t){t.createExplosion(this.x,this.y,50,this.color),this.markedForDeletion=!0}}class Ye extends W{radius=1;maxRadius=250;life=1;constructor(t,e){super(t,e,"#ffffff")}update(t){this.radius+=8*t.warpFactor,this.life-=.03,this.life<=0&&(this.markedForDeletion=!0)}draw(t){t.save(),t.beginPath(),t.arc(this.x,this.y,this.radius,0,Math.PI*2),t.strokeStyle=`rgba(255, 200, 200, ${this.life})`,t.lineWidth=20*this.life,t.stroke(),t.restore()}}class Je{static totalWeight=0;static initialized=!1;static upgradeList=[];static initialize(){if(this.initialized)return;const t=["SPEED_BOOST","DAMAGE_BOOST","SIZE_UP","SIZE_DOWN","GET_SHIELD","GET_TELEPORT","UPGRADE_RANGE","UPGRADE_BOMB","HEAL","GET_MINIGUN","GET_SHOTGUN","GET_RAILGUN","GET_MISSILE","GET_PLASMA","GET_FLAK","GET_WAVE","GET_SNIPER","SLOW_DOWN","WEAPON_JAM"];this.upgradeList=[];for(const e of t){const s=U.create(e);s&&s.weight>0&&this.upgradeList.push(s)}this.totalWeight=this.upgradeList.reduce((e,s)=>e+s.weight,0),this.initialized=!0}static generateType(){if(this.initialize(),this.upgradeList.length===0)return{type:"HEAL",isGood:!0};const t=Math.random()*this.totalWeight;let e=0;for(const i of this.upgradeList)if(e+=i.weight,t<e)return{type:i.type,isGood:i.isGood};const s=this.upgradeList[this.upgradeList.length-1];return s?{type:s.type,isGood:s.isGood}:{type:"HEAL",isGood:!0}}}class qe extends W{type;isGood;life=1200;pulse=0;constructor(t,e){const{type:s,isGood:i}=Je.generateType();super(t,e,i?x.COLORS.buff:x.COLORS.debuff),this.type=s,this.isGood=i,this.vx=u.randomRange(-2,2),this.vy=u.randomRange(-2,2)}update(t){this.x+=this.vx*t.warpFactor,this.y+=this.vy*t.warpFactor,this.vx*=.92,this.vy*=.92,this.pulse+=.1,this.life--,this.life<=0&&(this.markedForDeletion=!0)}}class Jt extends W{text;life=1;size=20;constructor(t,e,s,i){super(t,e,i),this.text=s,this.vy=-1.5,this.vx=u.randomRange(-.5,.5)}update(t){this.x+=this.vx,this.y+=this.vy,this.life-=.02,this.life<=0&&(this.markedForDeletion=!0)}draw(t){t.save(),t.globalAlpha=this.life,t.fillStyle=this.color,t.font=`bold ${this.size}px monospace`,t.textAlign="center",t.shadowColor="#000",t.shadowBlur=4,t.fillText(this.text,this.x,this.y),t.restore()}}class Dt extends Jt{constructor(t,e,s,i=!1){const a=Math.floor(s).toString(),r=i?"#ef4444":"#ffffff",n=i?24:14,l=u.randomRange(-10,10),h=u.randomRange(-10,10);super(t+l,e+h,a,r),this.size=n,i&&(this.vy=-2,this.vx=u.randomRange(-1,1))}static create(t,e,s,i=!1){return new Dt(t,e,s,i)}}class At extends Jt{constructor(t,e,s){const i=`+${Math.floor(s)}$`,a="#fbbf24",r=18,n=u.randomRange(-10,10),l=u.randomRange(-10,10);super(t+n,e+l,i,a),this.size=r,this.vy=-1.2,this.vx=u.randomRange(-.3,.3)}static create(t,e,s){return new At(t,e,s)}}class Ze{static applyAoeDamage(t,e,s,i,a){const r=[];for(const n of a){let l=!1;for(const h of n.segments)if(u.dist({x:t,y:e},h)<s){l=!0;break}if(l){const h=u.angle({x:t,y:e},n);r.push({serpent:n,damage:i,pushAngle:h})}}return r}}class Ke{canvas;renderer;width=0;height=0;warpFactor=1;mouse={x:-1e3,y:-1e3,down:!1};blackHole;stars=[];meteors=[];ships=[];projectiles=[];particles=[];serpents=[];cracks;shockwaves=[];powerUps=[];floatingTexts=[];constructor(t){this.canvas=t,this.renderer=new Ne(t.getContext("2d")),this.blackHole=new He(0,0),this.cracks=new ze,this.resize(),this.initStars()}resize(){this.width=window.innerWidth,this.height=window.innerHeight,this.canvas.width=this.width,this.canvas.height=this.height,this.blackHole.x=this.width/2,this.blackHole.y=this.height/2,this.stars.length===0&&this.initStars()}initStars(){this.stars=[];for(let t=0;t<x.POINT_COUNT;t++)this.stars.push(new je(u.randomRange(0,this.width),u.randomRange(0,this.height)))}spawnMeteor(){const t=Math.random()*Math.PI*2,e=Math.max(this.width,this.height)*.7,s=this.blackHole.x+Math.cos(t)*e,i=this.blackHole.y+Math.sin(t)*e,r=Math.random()>.85?500:100,n=this.blackHole.x+(Math.random()-.5)*r,l=this.blackHole.y+(Math.random()-.5)*r,h=u.angle({x:s,y:i},{x:n,y:l}),c=u.randomRange(2,4);this.meteors.push(new Bt(s,i,Math.cos(h)*c,Math.sin(h)*c,!1))}spawnShip(){const t=Math.random()*Math.PI*2,e=Math.max(this.width,this.height)/2+50,s=this.width/2+Math.cos(t)*e,i=this.height/2+Math.sin(t)*e;this.ships.push(new Ve(s,i,t+Math.PI))}spawnLaser(t,e,s,i,a,r,n=1){const h=new Mt().config,c=(Math.random()-.5)*h.spread,d=s+Math.cos(a+c)*h.speed,p=i+Math.sin(a+c)*h.speed;this.projectiles.push(new et(t+Math.cos(a)*15,e+Math.sin(a)*15,d,p,r||"#8b5cf6",h.damage*n,2,60))}spawnPowerUp(){let t,e,s;do t=u.randomRange(50,this.width-50),e=u.randomRange(50,this.height-50),s=u.dist({x:t,y:e},this.blackHole);while(s<200);this.powerUps.push(new qe(t,e))}spawnBomb(t,e,s,i,a,r=1){const n=x.BOMB_DAMAGE+(r-1)*10;this.projectiles.push(new _e(t+Math.cos(a)*10,e+Math.sin(a)*10,s+Math.cos(a)*6,i+Math.sin(a)*6,n))}createExplosion(t,e,s,i){if(this.particles.length>300)return;const a=Math.floor(s*.5);for(let r=0;r<a;r++){const n=Math.random()*Math.PI*2,l=u.randomRange(2,12);this.particles.push(new Vt(t,e,i,u.randomRange(2,6),Math.cos(n)*l,Math.sin(n)*l))}}spawnSupernovaDebris(){for(let e=0;e<60;e++){const s=Math.random()*Math.PI*2,i=u.randomRange(15,40);this.meteors.push(new Bt(this.blackHole.x,this.blackHole.y,Math.cos(s)*i,Math.sin(s)*i,!0))}this.createExplosion(this.blackHole.x,this.blackHole.y,50,"#ffffff"),this.cracks.generate(this.blackHole.x,this.blackHole.y,this.width,this.height)}spawnSerpent(){this.serpents.push(new gt(this.blackHole.x,this.blackHole.y))}addCoins(t,e,s){w.coins+=t;const i=At.create(e,s,t);this.floatingTexts.push(i)}spawnDamageText(t,e,s,i){const a=Dt.create(t,e,s,i);this.floatingTexts.push(a)}spawnShockwave(t,e){this.shockwaves.push(new Ye(t,e));const s=Ze.applyAoeDamage(t,e,250,10,this.serpents);for(const{serpent:i,damage:a,pushAngle:r}of s)i.takeDamage(this,a),i.x+=Math.cos(r)*20,i.y+=Math.sin(r)*20}update(){this.mouse.down?this.warpFactor+=(5-this.warpFactor)*.05:this.warpFactor+=(1-this.warpFactor)*.05,this.renderer.clear(this.width,this.height,this.warpFactor,this.blackHole.state===T.EXPLODING,this.blackHole.shockwaveRadius),this.cracks.update(this.blackHole.state===T.REFORMING),this.renderer.ctx&&this.cracks.draw(this.renderer.ctx),this.blackHole.update(this),this.renderer.drawBlackHole(this.blackHole),this.stars.forEach(e=>e.update(this)),this.renderer.drawStars(this.stars,this.warpFactor),this.blackHole.state===T.STABLE&&Math.random()<.003&&this.spawnSerpent();for(let e=this.serpents.length-1;e>=0;e--){const s=this.serpents[e];if(!s){this.serpents.splice(e,1);continue}s.update(this),this.renderer.drawVoidSerpent(s),s.markedForDeletion&&this.serpents.splice(e,1)}this.blackHole.state!==T.EXPLODING&&Math.random()<x.POWERUP_RATE&&this.spawnPowerUp();const t=this.meteors.filter(e=>!e.isDebris).length;this.blackHole.state!==T.EXPLODING&&t<x.MAX_METEORS&&Math.random()<.05&&this.spawnMeteor();for(let e=this.meteors.length-1;e>=0;e--){const s=this.meteors[e];if(!s){this.meteors.splice(e,1);continue}s.update(this),this.renderer.drawMeteor(s,this.warpFactor),s.markedForDeletion&&this.meteors.splice(e,1)}for(;this.ships.length<x.SHIP_COUNT;)this.spawnShip();for(let e=this.ships.length-1;e>=0;e--){const s=this.ships[e];if(!s){this.ships.splice(e,1);continue}s.update(this),this.renderer.drawShip(s),s.markedForDeletion&&this.ships.splice(e,1)}for(let e=this.projectiles.length-1;e>=0;e--){const s=this.projectiles[e];if(!s){this.projectiles.splice(e,1);continue}s.update(this),this.renderer.drawProjectile(s),s.markedForDeletion&&this.projectiles.splice(e,1)}for(let e=this.powerUps.length-1;e>=0;e--){const s=this.powerUps[e];if(!s){this.powerUps.splice(e,1);continue}s.update(this),this.renderer.drawPowerUp(s);for(const i of this.ships)if(pt.checkCircleCollision(s,i,25,0)){i.applyPowerUp(s),this.createExplosion(s.x,s.y,15,s.color),s.markedForDeletion=!0;break}s.markedForDeletion&&this.powerUps.splice(e,1)}for(let e=this.shockwaves.length-1;e>=0;e--){const s=this.shockwaves[e];if(!s){this.shockwaves.splice(e,1);continue}s.update(this),s.draw(this.renderer.ctx),s.markedForDeletion&&this.shockwaves.splice(e,1)}for(let e=this.particles.length-1;e>=0;e--){const s=this.particles[e];if(!s){this.particles.splice(e,1);continue}s.update(),this.renderer.drawParticle(s),s.markedForDeletion&&this.particles.splice(e,1)}for(let e=this.floatingTexts.length-1;e>=0;e--){const s=this.floatingTexts[e];if(!s){this.floatingTexts.splice(e,1);continue}s.update(this),s.draw(this.renderer.ctx),s.markedForDeletion&&this.floatingTexts.splice(e,1)}}}const Qe={class:"fixed inset-0 bg-[#0a0a0a] overflow-hidden font-mono text-white select-none"},ts={key:0,class:"absolute top-0 left-0 p-6 z-10 pointer-events-none"},es={class:"text-4xl font-bold text-yellow-400 drop-shadow-md"},ss={key:0,class:"absolute top-[60px] right-0 p-6 flex flex-col items-end space-y-4 z-10 pointer-events-none shop-container"},is={class:"flex flex-col space-y-2 pointer-events-auto"},as=["disabled"],os={class:"flex justify-between items-center w-48"},ns={class:"text-yellow-400 text-xs"},rs={class:"text-[10px] text-gray-500 text-right"},ls=["disabled"],cs={class:"flex justify-between items-center w-48"},hs={class:"text-yellow-400 text-xs"},ds={class:"text-[10px] text-gray-500 text-right"},us=["disabled"],fs={class:"flex justify-between items-center w-48"},ps={class:"text-yellow-400 text-xs"},gs={class:"text-[10px] text-gray-500 text-right"},xs=["disabled"],ys={class:"flex justify-between items-center w-48"},vs={class:"text-yellow-400 text-xs"},ms={class:"text-[10px] text-gray-500 text-right"},ws=["disabled"],bs={class:"flex justify-between items-center w-48"},Ms={class:"text-yellow-400 text-xs"},Ss={class:"text-[10px] text-gray-500 text-right"},Es=["disabled"],Ts={class:"flex justify-between items-center w-48"},_s={class:"text-yellow-400 text-xs"},Rs={class:"text-[10px] text-gray-500 text-right"},Ps=["disabled"],Is={class:"flex justify-between items-center w-48"},Ds={class:"text-yellow-400 text-xs"},As={class:"text-[10px] text-gray-500 text-right"},Cs=["disabled"],Os={class:"flex justify-between items-center w-48"},ks={class:"text-yellow-400 text-xs"},Ls={class:"text-[10px] text-gray-500 text-right"},Gs=_t({__name:"index",props:{showUI:{type:Boolean,default:!0}},setup(o){const t=ot(null);let e=null,s;const i=()=>{e?.resize()},a=h=>{e&&(e.mouse.x=h.clientX,e.mouse.y=h.clientY)},r=()=>{e&&(e.mouse.down=!0)},n=()=>{e&&(e.mouse.down=!1)},l=()=>{e?.update(),s=requestAnimationFrame(l)};return xt(()=>{t.value&&(e=new Ke(t.value),l(),window.addEventListener("resize",i),window.addEventListener("mousemove",a),window.addEventListener("mousedown",r),window.addEventListener("mouseup",n))}),Ft(()=>{cancelAnimationFrame(s),window.removeEventListener("resize",i),window.removeEventListener("mousemove",a),window.removeEventListener("mousedown",r),window.removeEventListener("mouseup",n)}),(h,c)=>(G(),N("div",Qe,[f("canvas",{ref_key:"canvasRef",ref:t,class:"absolute inset-0 block pointer-events-auto",style:{"z-index":"0"}},null,512),$(Lt,{name:"balance-fade"},{default:kt(()=>[o.showUI?bt("",!0):(G(),N("div",ts,[f("div",es,P(Math.floor(m(w).coins))+"$ ",1)]))]),_:1}),$(Lt,{name:"shop-fade"},{default:kt(()=>[o.showUI?bt("",!0):(G(),N("div",ss,[f("div",is,[f("button",{onClick:c[0]||(c[0]=d=>m(J)("ship")),class:"group relative px-4 py-2 bg-white/5 hover:bg-white/10 border border-white/10 rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",disabled:m(w).coins<m(C).ship},[f("div",os,[c[8]||(c[8]=f("span",{class:"text-sm text-gray-300 group-hover:text-white"},"Add Ship",-1)),f("span",ns,P(m(C).ship)+"$",1)]),f("div",rs,"Count: "+P(m(w).shipsCount),1)],8,as),f("button",{onClick:c[1]||(c[1]=d=>m(J)("damage")),class:"group px-4 py-2 bg-white/5 hover:bg-white/10 border border-white/10 rounded-lg transition-all disabled:opacity-50",disabled:m(w).coins<m(C).damage},[f("div",cs,[c[9]||(c[9]=f("span",{class:"text-sm text-gray-300 group-hover:text-white"},"Damage",-1)),f("span",hs,P(m(C).damage)+"$",1)]),f("div",ds,"Lvl: "+P(m(w).damageLevel),1)],8,ls),f("button",{onClick:c[2]||(c[2]=d=>m(J)("hull")),class:"group px-4 py-2 bg-white/5 hover:bg-white/10 border border-white/10 rounded-lg transition-all disabled:opacity-50",disabled:m(w).coins<m(C).hull},[f("div",fs,[c[10]||(c[10]=f("span",{class:"text-sm text-gray-300 group-hover:text-white"},"Hull HP",-1)),f("span",ps,P(m(C).hull)+"$",1)]),f("div",gs,"Lvl: "+P(m(w).hullLevel),1)],8,us),f("button",{onClick:c[3]||(c[3]=d=>m(J)("turret")),class:"group px-4 py-2 bg-white/5 hover:bg-white/10 border border-white/10 rounded-lg transition-all disabled:opacity-50",disabled:m(w).coins<m(C).turret},[f("div",ys,[c[11]||(c[11]=f("span",{class:"text-sm text-gray-300 group-hover:text-white"},"Fire Rate",-1)),f("span",vs,P(m(C).turret)+"$",1)]),f("div",ms,"Lvl: "+P(m(w).turretSpeed),1)],8,xs),c[16]||(c[16]=f("div",{class:"h-px bg-white/10 my-2"},null,-1)),f("button",{onClick:c[4]||(c[4]=d=>m(J)("shield")),class:"group px-4 py-2 bg-white/5 hover:bg-white/10 border border-white/10 rounded-lg transition-all disabled:opacity-50",disabled:m(w).coins<m(C).shield},[f("div",bs,[c[12]||(c[12]=f("span",{class:"text-sm text-blue-400 group-hover:text-blue-300"},"Shield Gen",-1)),f("span",Ms,P(m(C).shield)+"$",1)]),f("div",Ss,"Max: "+P(m(w).shieldLevel*5),1)],8,ws),f("button",{onClick:c[5]||(c[5]=d=>m(J)("crit")),class:"group px-4 py-2 bg-white/5 hover:bg-white/10 border border-white/10 rounded-lg transition-all disabled:opacity-50",disabled:m(w).coins<m(C).crit},[f("div",Ts,[c[13]||(c[13]=f("span",{class:"text-sm text-red-400 group-hover:text-red-300"},"Crit Chance",-1)),f("span",_s,P(m(C).crit)+"$",1)]),f("div",Rs,"Chance: "+P(m(w).critLevel*5)+"%",1)],8,Es),f("button",{onClick:c[6]||(c[6]=d=>m(J)("regen")),class:"group px-4 py-2 bg-white/5 hover:bg-white/10 border border-white/10 rounded-lg transition-all disabled:opacity-50",disabled:m(w).coins<m(C).regen},[f("div",Is,[c[14]||(c[14]=f("span",{class:"text-sm text-green-400 group-hover:text-green-300"},"Nanobots",-1)),f("span",Ds,P(m(C).regen)+"$",1)]),f("div",As,"Lvl: "+P(m(w).regenLevel),1)],8,Ps),f("button",{onClick:c[7]||(c[7]=d=>m(J)("magnet")),class:"group px-4 py-2 bg-white/5 hover:bg-white/10 border border-white/10 rounded-lg transition-all disabled:opacity-50",disabled:m(w).coins<m(C).magnet},[f("div",Os,[c[15]||(c[15]=f("span",{class:"text-sm text-purple-400 group-hover:text-purple-300"},"Magnet",-1)),f("span",ks,P(m(C).magnet)+"$",1)]),f("div",Ls,"Range: "+P(500+(m(w).magnetLevel-1)*150),1)],8,Cs)]),c[17]||(c[17]=f("div",{class:"text-[10px] text-gray-600 pt-4"},[q(" Hold Click: Warp Drive"),f("br"),q(" Killing Serpents gives $$$ ")],-1))]))]),_:1})]))}}),Bs=Object.assign(Ut(Gs,[["__scopeId","data-v-69d66cbc"]]),{__name:"Background"}),Ns={trailing:!0};function zs(o,t=25,e={}){if(e={...Ns,...e},!Number.isFinite(t))throw new TypeError("Expected `wait` to be a finite number");let s,i,a=[],r,n;const l=(d,p)=>(r=$s(o,d,p),r.finally(()=>{if(r=null,e.trailing&&n&&!i){const b=l(d,n);return n=null,b}}),r),h=function(...d){return e.trailing&&(n=d),r||new Promise(p=>{const b=!i&&e.leading;clearTimeout(i),i=setTimeout(()=>{i=null;const y=e.leading?s:l(this,d);n=null;for(const v of a)v(y);a=[]},t),b?(s=l(this,d),p(s)):a.push(p)})},c=d=>{d&&(clearTimeout(d),i=null)};return h.isPending=()=>!!i,h.cancel=()=>{c(i),a=[],n=null},h.flush=()=>{if(c(i),!n||r)return;const d=n;return n=null,l(this,d)},h}async function $s(o,t,e){return await o.apply(t,e)}function Fs(o){return typeof o=="string"?`'${o}'`:new Us().serialize(o)}const Us=(function(){class o{#t=new Map;compare(e,s){const i=typeof e,a=typeof s;return i==="string"&&a==="string"?e.localeCompare(s):i==="number"&&a==="number"?e-s:String.prototype.localeCompare.call(this.serialize(e,!0),this.serialize(s,!0))}serialize(e,s){if(e===null)return"null";switch(typeof e){case"string":return s?e:`'${e}'`;case"bigint":return`${e}n`;case"object":return this.$object(e);case"function":return this.$function(e)}return String(e)}serializeObject(e){const s=Object.prototype.toString.call(e);if(s!=="[object Object]")return this.serializeBuiltInType(s.length<10?`unknown:${s}`:s.slice(8,-1),e);const i=e.constructor,a=i===Object||i===void 0?"":i.name;if(a!==""&&globalThis[a]===i)return this.serializeBuiltInType(a,e);if(typeof e.toJSON=="function"){const r=e.toJSON();return a+(r!==null&&typeof r=="object"?this.$object(r):`(${this.serialize(r)})`)}return this.serializeObjectEntries(a,Object.entries(e))}serializeBuiltInType(e,s){const i=this["$"+e];if(i)return i.call(this,s);if(typeof s?.entries=="function")return this.serializeObjectEntries(e,s.entries());throw new Error(`Cannot serialize ${e}`)}serializeObjectEntries(e,s){const i=Array.from(s).sort((r,n)=>this.compare(r[0],n[0]));let a=`${e}{`;for(let r=0;r<i.length;r++){const[n,l]=i[r];a+=`${this.serialize(n,!0)}:${this.serialize(l)}`,r<i.length-1&&(a+=",")}return a+"}"}$object(e){let s=this.#t.get(e);return s===void 0&&(this.#t.set(e,`#${this.#t.size}`),s=this.serializeObject(e),this.#t.set(e,s)),s}$function(e){const s=Function.prototype.toString.call(e);return s.slice(-15)==="[native code] }"?`${e.name||""}()[native]`:`${e.name}(${e.length})${s.replace(/\s*\n\s*/g,"")}`}$Array(e){let s="[";for(let i=0;i<e.length;i++)s+=this.serialize(e[i]),i<e.length-1&&(s+=",");return s+"]"}$Date(e){try{return`Date(${e.toISOString()})`}catch{return"Date(null)"}}$ArrayBuffer(e){return`ArrayBuffer[${new Uint8Array(e).join(",")}]`}$Set(e){return`Set${this.$Array(Array.from(e).sort((s,i)=>this.compare(s,i)))}`}$Map(e){return this.serializeObjectEntries("Map",e.entries())}}for(const t of["Error","RegExp","URL"])o.prototype["$"+t]=function(e){return`${t}(${e})`};for(const t of["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"])o.prototype["$"+t]=function(e){return`${t}[${e.join(",")}]`};for(const t of["BigInt64Array","BigUint64Array"])o.prototype["$"+t]=function(e){return`${t}[${e.join("n,")}${e.length>0?"n":""}]`};return o})(),Hs=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],js=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],Ws="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",Q=[];class Xs{_data=new at;_hash=new at([...Hs]);_nDataBytes=0;_minBufferSize=0;finalize(t){t&&this._append(t);const e=this._nDataBytes*8,s=this._data.sigBytes*8;return this._data.words[s>>>5]|=128<<24-s%32,this._data.words[(s+64>>>9<<4)+14]=Math.floor(e/4294967296),this._data.words[(s+64>>>9<<4)+15]=e,this._data.sigBytes=this._data.words.length*4,this._process(),this._hash}_doProcessBlock(t,e){const s=this._hash.words;let i=s[0],a=s[1],r=s[2],n=s[3],l=s[4],h=s[5],c=s[6],d=s[7];for(let p=0;p<64;p++){if(p<16)Q[p]=t[e+p]|0;else{const R=Q[p-15],M=(R<<25|R>>>7)^(R<<14|R>>>18)^R>>>3,g=Q[p-2],A=(g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10;Q[p]=M+Q[p-7]+A+Q[p-16]}const b=l&h^~l&c,y=i&a^i&r^a&r,v=(i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22),D=(l<<26|l>>>6)^(l<<21|l>>>11)^(l<<7|l>>>25),E=d+D+b+js[p]+Q[p],_=v+y;d=c,c=h,h=l,l=n+E|0,n=r,r=a,a=i,i=E+_|0}s[0]=s[0]+i|0,s[1]=s[1]+a|0,s[2]=s[2]+r|0,s[3]=s[3]+n|0,s[4]=s[4]+l|0,s[5]=s[5]+h|0,s[6]=s[6]+c|0,s[7]=s[7]+d|0}_append(t){typeof t=="string"&&(t=at.fromUtf8(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes}_process(t){let e,s=this._data.sigBytes/64;t?s=Math.ceil(s):s=Math.max((s|0)-this._minBufferSize,0);const i=s*16,a=Math.min(i*4,this._data.sigBytes);if(i){for(let r=0;r<i;r+=16)this._doProcessBlock(this._data.words,r);e=this._data.words.splice(0,i),this._data.sigBytes-=a}return new at(e,a)}}class at{words;sigBytes;constructor(t,e){t=this.words=t||[],this.sigBytes=e===void 0?t.length*4:e}static fromUtf8(t){const e=unescape(encodeURIComponent(t)),s=e.length,i=[];for(let a=0;a<s;a++)i[a>>>2]|=(e.charCodeAt(a)&255)<<24-a%4*8;return new at(i,s)}toBase64(){const t=[];for(let e=0;e<this.sigBytes;e+=3){const s=this.words[e>>>2]>>>24-e%4*8&255,i=this.words[e+1>>>2]>>>24-(e+1)%4*8&255,a=this.words[e+2>>>2]>>>24-(e+2)%4*8&255,r=s<<16|i<<8|a;for(let n=0;n<4&&e*8+n*6<this.sigBytes*8;n++)t.push(Ws.charAt(r>>>6*(3-n)&63))}return t.join("")}concat(t){if(this.words[this.sigBytes>>>2]&=4294967295<<32-this.sigBytes%4*8,this.words.length=Math.ceil(this.sigBytes/4),this.sigBytes%4)for(let e=0;e<t.sigBytes;e++){const s=t.words[e>>>2]>>>24-e%4*8&255;this.words[this.sigBytes+e>>>2]|=s<<24-(this.sigBytes+e)%4*8}else for(let e=0;e<t.sigBytes;e+=4)this.words[this.sigBytes+e>>>2]=t.words[e>>>2];this.sigBytes+=t.sigBytes}}function Vs(o){return new Xs().finalize(o).toBase64()}function it(o){return Vs(Fs(o))}const Ys=Symbol.for("nuxt:client-only");function Js(...o){const t=typeof o[o.length-1]=="string"?o.pop():void 0;qs(o[0],o[1])&&o.unshift(t);let[e,s,i={}]=o,a=!1;const r=H(()=>O(e));if(typeof r.value!="string")throw new TypeError("[nuxt] [useAsyncData] key must be a string.");if(typeof s!="function")throw new TypeError("[nuxt] [useAsyncData] handler must be a function.");const n=ee();i.server??=!0,i.default??=Ks,i.getCachedData??=Zt,i.lazy??=!1,i.immediate??=!0,i.deep??=se.deep,i.dedupe??="cancel",i._functionName,n._asyncData[r.value];function l(){const y={cause:"initial",dedupe:i.dedupe};return n._asyncData[r.value]?._init||(y.cachedData=i.getCachedData(r.value,n,{cause:"initial"}),n._asyncData[r.value]=zt(n,r.value,s,i,y.cachedData)),()=>n._asyncData[r.value].execute(y)}const h=l(),c=n._asyncData[r.value];c._deps++;const d=i.server!==!1&&n.payload.serverRendered;{let y=function(M){const g=n._asyncData[M];g?._deps&&(g._deps--,g._deps===0&&g?._off())};const v=Rt();if(v&&d&&i.immediate&&!v.sp&&(v.sp=[]),v&&!v._nuxtOnBeforeMountCbs){v._nuxtOnBeforeMountCbs=[];const M=v._nuxtOnBeforeMountCbs;ie(()=>{M.forEach(g=>{g()}),M.splice(0,M.length)}),Ft(()=>M.splice(0,M.length))}const D=v&&(v._nuxtClientOnly||ae(Ys,!1));d&&n.isHydrating&&(c.error.value||c.data.value!==void 0)?c.status.value=c.error.value?"error":"success":v&&(!D&&n.payload.serverRendered&&n.isHydrating||i.lazy)&&i.immediate?v._nuxtOnBeforeMountCbs.push(h):i.immediate&&c.status.value!=="success"&&h();const E=jt(),_=nt(r,(M,g)=>{if((M||g)&&M!==g){a=!0;const A=n._asyncData[g]?.data.value!==void 0,S=n._asyncDataPromises[g]!==void 0,k={cause:"initial",dedupe:i.dedupe};if(!n._asyncData[M]?._init){let L;g&&A?L=n._asyncData[g].data.value:(L=i.getCachedData(M,n,{cause:"initial"}),k.cachedData=L),n._asyncData[M]=zt(n,M,s,i,L)}n._asyncData[M]._deps++,g&&y(g),(i.immediate||A||S)&&n._asyncData[M].execute(k),re(()=>{a=!1})}},{flush:"sync"}),R=i.watch?nt(i.watch,()=>{a||c._execute({cause:"watch",dedupe:i.dedupe})}):()=>{};E&&Ht(()=>{_(),R(),y(r.value)})}const p={data:ht(()=>n._asyncData[r.value]?.data),pending:ht(()=>n._asyncData[r.value]?.pending),status:ht(()=>n._asyncData[r.value]?.status),error:ht(()=>n._asyncData[r.value]?.error),refresh:(...y)=>n._asyncData[r.value]?._init?n._asyncData[r.value].execute(...y):l()(),execute:(...y)=>p.refresh(...y),clear:()=>{const y=n._asyncData[r.value];if(y?._abortController)try{y._abortController.abort(new DOMException("AsyncData aborted by user.","AbortError"))}finally{y._abortController=void 0}qt(n,r.value)}},b=Promise.resolve(n._asyncDataPromises[r.value]).then(()=>p);return Object.assign(b,p),b}function ht(o){return H({get(){return o()?.value},set(t){const e=o();e&&(e.value=t)}})}function qs(o,t){return!(typeof o=="string"||typeof o=="object"&&o!==null||typeof o=="function"&&typeof t=="function")}function qt(o,t){t in o.payload.data&&(o.payload.data[t]=void 0),t in o.payload._errors&&(o.payload._errors[t]=void 0),o._asyncData[t]&&(o._asyncData[t].data.value=m(o._asyncData[t]._default()),o._asyncData[t].error.value=void 0,o._asyncData[t].status.value="idle"),t in o._asyncDataPromises&&(o._asyncDataPromises[t]=void 0)}function Zs(o,t){const e={};for(const s of t)e[s]=o[s];return e}function zt(o,t,e,s,i){o.payload._errors[t]??=void 0;const a=s.getCachedData!==Zt,r=e,n=s.deep?ot:B,l=i!==void 0,h=o.hook("app:data:refresh",async d=>{(!d||d.includes(t))&&await c.execute({cause:"refresh:hook"})}),c={data:n(l?i:s.default()),pending:H(()=>c.status.value==="pending"),error:oe(o.payload._errors,t),status:B("idle"),execute:(...d)=>{const[p,b=void 0]=d,y=p&&b===void 0&&typeof p=="object"?p:{};if(o._asyncDataPromises[t]&&(y.dedupe??s.dedupe)==="defer")return o._asyncDataPromises[t];{const E="cachedData"in y?y.cachedData:s.getCachedData(t,o,{cause:y.cause??"refresh:manual"});if(E!==void 0)return o.payload.data[t]=c.data.value=E,c.error.value=void 0,c.status.value="success",Promise.resolve(E)}c._abortController&&c._abortController.abort(new DOMException("AsyncData request cancelled by deduplication","AbortError")),c._abortController=new AbortController,c.status.value="pending";const v=new AbortController,D=new Promise((E,_)=>{try{const R=y.timeout??s.timeout,M=Qs([c._abortController?.signal,y?.signal],v.signal,R);if(M.aborted){const g=M.reason;_(g instanceof Error?g:new DOMException(String(g??"Aborted"),"AbortError"));return}return M.addEventListener("abort",()=>{const g=M.reason;_(g instanceof Error?g:new DOMException(String(g??"Aborted"),"AbortError"))},{once:!0,signal:v.signal}),Promise.resolve(r(o,{signal:M})).then(E,_)}catch(R){_(R)}}).then(async E=>{let _=E;s.transform&&(_=await s.transform(E)),s.pick&&(_=Zs(_,s.pick)),o.payload.data[t]=_,c.data.value=_,c.error.value=void 0,c.status.value="success"}).catch(E=>{if(!(o._asyncDataPromises[t]&&o._asyncDataPromises[t]!==D)&&!c._abortController?.signal.aborted){if(typeof DOMException<"u"&&E instanceof DOMException&&E.name==="AbortError"){c.status.value="idle";return}c.error.value=ne(E),c.data.value=m(s.default()),c.status.value="error"}}).finally(()=>{v.abort(),delete o._asyncDataPromises[t]});return o._asyncDataPromises[t]=D,o._asyncDataPromises[t]},_execute:zs((...d)=>c.execute(...d),0,{leading:!0}),_default:s.default,_deps:0,_init:!0,_hash:void 0,_off:()=>{h(),o._asyncData[t]?._init&&(o._asyncData[t]._init=!1),a||Wt(()=>{o._asyncData[t]?._init||(qt(o,t),c.execute=()=>Promise.resolve())})}};return c}const Ks=()=>{},Zt=(o,t,e)=>{if(t.isHydrating)return t.payload.data[o];if(e.cause!=="refresh:manual"&&e.cause!=="refresh:hook")return t.static.data[o]};function Qs(o,t,e){const s=o.filter(r=>!!r);if(typeof e=="number"&&e>=0){const r=AbortSignal.timeout?.(e);r&&s.push(r)}if(AbortSignal.any)return AbortSignal.any(s);const i=new AbortController;for(const r of s)if(r.aborted){const n=r.reason??new DOMException("Aborted","AbortError");try{i.abort(n)}catch{i.abort()}return i.signal}const a=()=>{const n=s.find(l=>l.aborted)?.reason??new DOMException("Aborted","AbortError");try{i.abort(n)}catch{i.abort()}};for(const r of s)r.addEventListener?.("abort",a,{once:!0,signal:t});return i.signal}function Ct(o,t){return jt()?(Ht(o,t),!0):!1}const ti=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const ei=o=>o!=null,si=Object.prototype.toString,ii=o=>si.call(o)==="[object Object]";function ft(o){return Array.isArray(o)?o:[o]}function ai(o){return Rt()}function oi(o,t=!0,e){ai()?xt(o,e):t?o():Wt(o)}function ni(o,t,e){return nt(o,t,{...e,immediate:!0})}const ct=ti?window:void 0;function lt(o){var t;const e=O(o);return(t=e?.$el)!==null&&t!==void 0?t:e}function tt(...o){const t=[],e=()=>{t.forEach(n=>n()),t.length=0},s=(n,l,h,c)=>(n.addEventListener(l,h,c),()=>n.removeEventListener(l,h,c)),i=H(()=>{const n=ft(O(o[0])).filter(l=>l!=null);return n.every(l=>typeof l!="string")?n:void 0}),a=ni(()=>{var n,l;return[(n=(l=i.value)===null||l===void 0?void 0:l.map(h=>lt(h)))!==null&&n!==void 0?n:[ct].filter(h=>h!=null),ft(O(i.value?o[1]:o[0])),ft(m(i.value?o[2]:o[1])),O(i.value?o[3]:o[2])]},([n,l,h,c])=>{if(e(),!n?.length||!l?.length||!h?.length)return;const d=ii(c)?{...c}:c;t.push(...n.flatMap(p=>l.flatMap(b=>h.map(y=>s(p,b,y,d)))))},{flush:"post"}),r=()=>{a(),e()};return Ct(e),r}function ri(){const o=B(!1),t=Rt();return t&&xt(()=>{o.value=!0},t),o}function Kt(o){const t=ri();return H(()=>(t.value,!!o()))}function li(o,t,e={}){const{window:s=ct,...i}=e;let a;const r=Kt(()=>s&&"MutationObserver"in s),n=()=>{a&&(a.disconnect(),a=void 0)},l=nt(H(()=>{const d=ft(O(o)).map(lt).filter(ei);return new Set(d)}),d=>{n(),r.value&&d.size&&(a=new MutationObserver(t),d.forEach(p=>a.observe(p,i)))},{immediate:!0,flush:"post"}),h=()=>a?.takeRecords(),c=()=>{l(),n()};return Ct(c),{isSupported:r,stop:c,takeRecords:h}}function ci(o,t,e={}){const{window:s=ct,...i}=e;let a;const r=Kt(()=>s&&"ResizeObserver"in s),n=()=>{a&&(a.disconnect(),a=void 0)},l=nt(H(()=>{const c=O(o);return Array.isArray(c)?c.map(d=>lt(d)):[lt(c)]}),c=>{if(n(),r.value&&s){a=new ResizeObserver(t);for(const d of c)d&&a.observe(d,i)}},{immediate:!0,flush:"post"}),h=()=>{n(),l()};return Ct(h),{isSupported:r,stop:h}}const hi={page:o=>[o.pageX,o.pageY],client:o=>[o.clientX,o.clientY],screen:o=>[o.screenX,o.screenY],movement:o=>o instanceof MouseEvent?[o.movementX,o.movementY]:null};function di(o={}){const{type:t="page",touch:e=!0,resetOnTouchEnds:s=!1,initialValue:i={x:0,y:0},window:a=ct,target:r=a,scroll:n=!0,eventFilter:l}=o;let h=null,c=0,d=0;const p=B(i.x),b=B(i.y),y=B(null),v=typeof t=="function"?t:hi[t],D=S=>{const k=v(S);h=S,k&&([p.value,b.value]=k,y.value="mouse"),a&&(c=a.scrollX,d=a.scrollY)},E=S=>{if(S.touches.length>0){const k=v(S.touches[0]);k&&([p.value,b.value]=k,y.value="touch")}},_=()=>{if(!h||!a)return;const S=v(h);h instanceof MouseEvent&&S&&(p.value=S[0]+a.scrollX-c,b.value=S[1]+a.scrollY-d)},R=()=>{p.value=i.x,b.value=i.y},M=l?S=>l(()=>D(S),{}):S=>D(S),g=l?S=>l(()=>E(S),{}):S=>E(S),A=l?()=>l(()=>_(),{}):()=>_();if(r){const S={passive:!0};tt(r,["mousemove","dragover"],M,S),e&&t!=="movement"&&(tt(r,["touchstart","touchmove"],g,S),s&&tt(r,"touchend",R,S)),n&&t==="page"&&tt(a,"scroll",A,S)}return{x:p,y:b,sourceType:y}}function ui(o,t={}){const{windowResize:e=!0,windowScroll:s=!0,handleOutside:i=!0,window:a=ct}=t,r=t.type||"page",{x:n,y:l,sourceType:h}=di(t),c=B(o??a?.document.body),d=B(0),p=B(0),b=B(0),y=B(0),v=B(0),D=B(0),E=B(!0);function _(){if(!a)return;const g=lt(c);if(!g||!(g instanceof Element))return;const{left:A,top:S,width:k,height:L}=g.getBoundingClientRect();b.value=A+(r==="page"?a.pageXOffset:0),y.value=S+(r==="page"?a.pageYOffset:0),v.value=L,D.value=k;const vt=n.value-b.value,mt=l.value-y.value;E.value=k===0||L===0||vt<0||mt<0||vt>k||mt>L,(i||!E.value)&&(d.value=vt,p.value=mt)}const R=[];function M(){R.forEach(g=>g()),R.length=0}if(oi(()=>{_()}),a){const{stop:g}=ci(c,_),{stop:A}=li(c,_,{attributeFilter:["style","class"]}),S=nt([c,n,l],_);R.push(g,A,S),tt(document,"mouseleave",()=>E.value=!0,{passive:!0}),s&&R.push(tt("scroll",_,{capture:!0,passive:!0})),e&&R.push(tt("resize",_,{passive:!0}))}return{x:n,y:l,sourceType:h,elementX:d,elementY:p,elementPositionX:b,elementPositionY:y,elementHeight:v,elementWidth:D,isOutside:E,stop:M}}const fi=["href"],pi={class:"relative z-10"},gi={class:"flex justify-between items-start mb-4"},xi={class:"p-2 bg-white/5 rounded-lg group-hover:bg-primary/20 transition-colors duration-300"},yi={class:"flex items-center space-x-1 text-gray-400 bg-black/20 px-2 py-1 rounded-full"},vi={class:"text-xs font-mono font-bold"},mi={class:"text-lg font-bold text-white mb-2 group-hover:text-primary transition-colors"},wi={class:"text-gray-400 text-sm leading-relaxed mb-4 line-clamp-3 h-[4.5em]"},bi={class:"flex flex-wrap gap-2 mb-4 h-6 overflow-hidden"},Mi={class:"relative z-10 flex items-center justify-between mt-auto border-t border-white/5 pt-4"},Si={class:"flex items-center gap-2"},Ei=_t({__name:"ProjectCard",props:{project:{},index:{}},setup(o){const t=ot(null),{elementX:e,elementY:s,isOutside:i,elementHeight:a,elementWidth:r}=ui(t),n=H(()=>{if(i.value)return"";const h=6,c=(h/2-s.value/a.value*h).toFixed(2),d=(e.value/r.value*h-h/2).toFixed(2);return`perspective(1000px) rotateX(${c}deg) rotateY(${d}deg) scale(1.02)`}),l={TypeScript:"text-blue-400",Vue:"text-green-400",Python:"text-yellow-400",PHP:"text-purple-400",JavaScript:"text-yellow-300",Go:"text-cyan-400",HTML:"text-orange-400",CSS:"text-blue-300"};return(h,c)=>{const d=Xt;return G(),N("a",{href:o.project.url,target:"_blank",ref_key:"target",ref:t,style:le({transform:n.value,transition:m(i)?"transform 0.5s ease":"none",animationDelay:`${o.index*50}ms`}),class:"project-card group relative flex flex-col justify-between p-6 bg-surface/40 backdrop-blur-sm border border-white/5 rounded-2xl hover:border-primary/50 hover:shadow-2xl hover:shadow-primary/10 hover:bg-surface/60 animate-slide-up opacity-0"},[c[0]||(c[0]=f("div",{class:"absolute inset-0 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none bg-gradient-to-br from-white/5 to-transparent"},null,-1)),f("div",pi,[f("div",gi,[f("div",xi,[$(d,{name:"lucide:folder-git-2",class:"w-6 h-6 text-gray-300 group-hover:text-primary"})]),f("div",yi,[$(d,{name:"lucide:star",class:"w-3.5 h-3.5"}),f("span",vi,P(o.project.stars),1)])]),f("h3",mi,P(o.project.name),1),f("p",wi,P(o.project.description||"No description provided"),1),f("div",bi,[(G(!0),N(dt,null,ut(o.project.topics.slice(0,3),p=>(G(),N("span",{key:p,class:"text-[10px] px-2 py-0.5 rounded-full bg-white/5 text-gray-400"},P(p),1))),128))])]),f("div",Mi,[f("div",Si,[f("span",{class:Gt(["w-2 h-2 rounded-full",o.project.language==="Vue"?"bg-green-500":o.project.language==="TypeScript"?"bg-blue-500":"bg-gray-500"])},null,2),f("span",{class:Gt(["text-xs font-mono",l[o.project.language]||"text-gray-400"])},P(o.project.language||"Code"),3)]),$(d,{name:"lucide:arrow-up-right",class:"w-4 h-4 text-gray-500 group-hover:text-primary group-hover:translate-x-0.5 group-hover:-translate-y-0.5 transition-all"})])],12,fi)}}}),Ti=Object.assign(Ut(Ei,[["__scopeId","data-v-c0feffde"]]),{__name:"ProjectCard"});function _i(o,t,e){const[s={},i]=typeof t=="string"?[{},t]:[t,e],a=H(()=>O(o)),r=H(()=>O(s.key)||"$f"+it([i,typeof a.value=="string"?a.value:"",...Ri(s)]));if(!s.baseURL&&typeof a.value=="string"&&a.value[0]==="/"&&a.value[1]==="/")throw new Error('[nuxt] [useFetch] the request URL must not start with "//".');const{server:n,lazy:l,default:h,transform:c,pick:d,watch:p,immediate:b,getCachedData:y,deep:v,dedupe:D,timeout:E,..._}=s,R=Tt({...ce,..._,cache:typeof s.cache=="boolean"?void 0:s.cache}),M={server:n,lazy:l,default:h,transform:c,pick:d,immediate:b,getCachedData:y,deep:v,dedupe:D,timeout:E,watch:p===!1?[]:[...p||[],R]};return Js(p===!1?r.value:r,(A,{signal:S})=>(s.$fetch||globalThis.$fetch)(a.value,{signal:S,...R}),M)}function Ri(o){const t=[O(o.method)?.toUpperCase()||"GET",O(o.baseURL)];for(const e of[o.query||o.params]){const s=O(e);if(!s)continue;const i={};for(const[a,r]of Object.entries(s))i[O(a)]=O(r);t.push(i)}if(o.body){const e=O(o.body);if(!e)t.push(it(e));else if(e instanceof ArrayBuffer)t.push(it(Object.fromEntries([...new Uint8Array(e).entries()].map(([s,i])=>[s,i.toString()]))));else if(e instanceof FormData){const s={};for(const i of e.entries()){const[a,r]=i;s[a]=r instanceof File?r.name:r}t.push(it(s))}else if(he(e))t.push(it(Tt(e)));else try{t.push(it(e))}catch{console.warn("[useFetch] Failed to hash body",e)}}return t}const Pi=globalThis.setInterval,Ii={class:"min-h-screen text-white relative selection:bg-primary selection:text-white overflow-x-hidden"},Di=["title"],Ai={class:"relative z-10"},Ci={class:"container mx-auto px-6 py-24 max-w-7xl"},Oi={class:"mb-32 max-w-3xl"},ki={class:"text-2xl md:text-3xl text-gray-400 mb-10 font-light h-20 md:h-auto"},Li={class:"text-white"},Gi={key:0,class:"animate-blink"},Bi={class:"flex flex-wrap gap-4 animate-fade-in-up",style:{"animation-delay":"300ms"}},Ni=["href"],zi={class:"font-medium"},$i={class:"flex items-end justify-between mb-12 border-b border-white/10 pb-4"},Fi={class:"text-3xl font-bold flex items-center gap-3 mb-2"},Ui={href:"https://github.com/s00d?tab=repositories",target:"_blank",class:"hidden md:flex items-center gap-2 text-sm text-gray-400 hover:text-white transition-colors group"},Hi={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},ji={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 perspective-grid"},Wi={class:"mt-12 text-center md:hidden"},Xi={href:"https://github.com/s00d?tab=repositories",target:"_blank",class:"inline-flex items-center gap-2 text-sm text-gray-400 hover:text-white transition-colors border border-white/10 px-6 py-3 rounded-full"},Vi={class:"mt-40 pt-8 border-t border-white/10 flex flex-col md:flex-row justify-between items-center text-gray-500 text-sm"},Yi={class:"mt-2 md:mt-0 flex items-center gap-2"},$t="Backend & Frontend Developer building useful things.",Ki=_t({__name:"index",async setup(o){let t,e;const{data:s,pending:i}=([t,e]=de(()=>_i("/api/projects.json",{default:()=>[]},"$77hSeXQoip")),t=await t,e(),t),a=[{name:"GitHub",url:"https://github.com/s00d",icon:"lucide:github"},{name:"LinkedIn",url:"https://www.linkedin.com/in/s00d/",icon:"lucide:linkedin"},{name:"Telegram",url:"tg://resolve?domain=is_s00d",icon:"lucide:send"},{name:"Email",url:"mailto:Virus191288@gmail.com",icon:"lucide:mail"}],r=ot(""),n=ot(!0),l=ot(!0),h=()=>{l.value=!l.value};return xt(()=>{let c=0;const d=Pi(()=>{c<$t.length?(r.value+=$t.charAt(c),c++):(clearInterval(d),n.value=!1)},50)}),(c,d)=>{const p=Bs,b=Xt,y=Ti;return G(),N("div",Ii,[$(p,{showUI:l.value},null,8,["showUI"]),f("button",{onClick:h,class:"fixed top-4 right-4 z-50 w-12 h-12 flex items-center justify-center bg-white/10 backdrop-blur-md rounded-full border border-white/20 hover:bg-white/20 transition-all duration-300 hover:scale-110 group",title:l.value?"Ð¡ÐºÑ€Ñ‹Ñ‚ÑŒ Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ":"ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ"},[$(b,{name:l.value?"lucide:eye-off":"lucide:eye",class:"w-5 h-5 text-white group-hover:text-primary transition-colors"},null,8,["name"])],8,Di),ue(f("div",Ai,[f("main",Ci,[f("header",Oi,[d[0]||(d[0]=f("div",{class:"animate-fade-in-down"},[f("span",{class:"inline-block px-3 py-1 mb-6 text-xs font-mono font-medium tracking-wider text-primary bg-primary/10 rounded-full border border-primary/20"}," HELLO, WORLD "),f("h1",{class:"text-6xl md:text-8xl font-bold mb-8 tracking-tight leading-tight"},[q(" Pavel "),f("span",{class:"text-transparent bg-clip-text bg-gradient-to-r from-white via-gray-200 to-gray-500"}," Kuz'min ")])],-1)),f("h2",ki,[f("span",Li,P(r.value),1),n.value?(G(),N("span",Gi,"|")):bt("",!0)]),f("div",Bi,[(G(),N(dt,null,ut(a,v=>f("a",{key:v.name,href:v.url,target:"_blank",class:"group flex items-center space-x-2 px-5 py-3 bg-surface/50 backdrop-blur-md rounded-full hover:bg-white/10 border border-white/10 hover:border-primary/50 transition-all duration-300 hover:scale-105"},[$(b,{name:v.icon,class:"w-5 h-5 text-gray-300 group-hover:text-primary transition-colors"},null,8,["name"]),f("span",zi,P(v.name),1)],8,Ni)),64))])]),f("section",null,[f("div",$i,[f("div",null,[f("h2",Fi,[$(b,{name:"lucide:code-2",class:"text-primary"}),d[1]||(d[1]=q(" Selected Projects ",-1))]),d[2]||(d[2]=f("p",{class:"text-gray-400 text-sm"},"Open source contributions and personal labs",-1))]),f("a",Ui,[d[3]||(d[3]=q(" View all on GitHub ",-1)),$(b,{name:"lucide:arrow-right",class:"w-4 h-4 group-hover:translate-x-1 transition-transform"})])]),m(i)?(G(),N("div",Hi,[(G(),N(dt,null,ut(6,v=>f("div",{key:v,class:"h-64 bg-white/5 rounded-2xl animate-pulse border border-white/5"})),64))])):(G(),N("div",ji,[(G(!0),N(dt,null,ut(m(s),(v,D)=>(G(),pe(y,{key:v.id,project:v,index:D},null,8,["project","index"]))),128))])),f("div",Wi,[f("a",Xi,[d[4]||(d[4]=q(" View all on GitHub ",-1)),$(b,{name:"lucide:arrow-right",class:"w-4 h-4"})])])]),f("footer",Vi,[f("p",null,"Â© "+P(new Date().getFullYear())+" Pavel Kuz'min.",1),f("p",Yi,[d[5]||(d[5]=q(" Built with ",-1)),$(b,{name:"logos:nuxt-icon",class:"w-4 h-4 grayscale opacity-50"}),d[6]||(d[6]=q(" Nuxt 3 & Tailwind ",-1))])])])],512),[[fe,l.value]])])}}});export{Ki as default};
